<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patches contributed by University of Minnesota</title>
    <style>
    .pagination {
        border-top: 1px solid #ddd;
        border-bottom: 1px solid #ddd;
        overflow-wrap: break-word;
    }
    .pagination a, .pagination span {
        margin: 0 4px;
    }

    </style>
</head>
<body>
    <h1>Patches contributed by University of Minnesota</h1>
    <div class="pagination">
        <a href='7_8.html'>&lt;&lt;Prev</a><a href='7.html'>1</a><a href='7_2.html'>2</a><a href='7_3.html'>3</a><a href='7_4.html'>4</a><a href='7_5.html'>5</a><a href='7_6.html'>6</a><a href='7_7.html'>7</a><a href='7_8.html'>8</a><span>[9]</span><a href='7_10.html'>10</a><a href='7_11.html'>11</a><a href='7_12.html'>12</a><a href='7_13.html'>13</a><a href='7_14.html'>14</a><a href='7_15.html'>15</a><a href='7_16.html'>16</a><a href='7_17.html'>17</a><a href='7_18.html'>18</a><a href='7_19.html'>19</a><a href='7_20.html'>20</a><a href='7_21.html'>21</a><a href='7_22.html'>22</a><a href='7_23.html'>23</a><a href='7_24.html'>24</a><a href='7_25.html'>25</a><a href='7_26.html'>26</a><a href='7_27.html'>27</a><a href='7_28.html'>28</a><a href='7_29.html'>29</a><a href='7_30.html'>30</a><a href='7_10.html'>Next&gt;&gt;</a>
    </div>
    <hr>
    <pre>commit 67e2d2eb542338145a2e0b2336c1cdabd2424fd3
Author: Aditya Pakki &lt;pakki001@umn.edu&gt;
Date:   Thu Jan 30 22:11:33 2020 -0800

    fs: ocfs: remove unnecessary assertion in dlm_migrate_lockres
    
    In the only caller of dlm_migrate_lockres() - dlm_empty_lockres(),
    target is checked for O2NM_MAX_NODES.  Thus, the assertion in
    dlm_migrate_lockres() is unnecessary and can be removed.  The patch
    eliminates such a check.
    
    Link: http://lkml.kernel.org/r/20191218194111.26041-1-pakki001@umn.edu
    Signed-off-by: Aditya Pakki &lt;pakki001@umn.edu&gt;
    Cc: Mark Fasheh &lt;mark@fasheh.com&gt;
    Cc: Joel Becker &lt;jlbec@evilplan.org&gt;
    Cc: Junxiao Bi &lt;junxiao.bi@oracle.com&gt;
    Cc: Joseph Qi &lt;jiangqi903@gmail.com&gt;
    Cc: Changwei Ge &lt;gechangwei@live.cn&gt;
    Cc: Gang He &lt;ghe@suse.com&gt;
    Cc: Jun Piao &lt;piaojun@huawei.com&gt;
    Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    Signed-off-by: Linus Torvalds &lt;torvalds@linux-foundation.org&gt;

diff --git a/fs/ocfs2/dlm/dlmmaster.c b/fs/ocfs2/dlm/dlmmaster.c
index 74b768ca1cd8..3b239637f884 100644
--- a/fs/ocfs2/dlm/dlmmaster.c
+++ b/fs/ocfs2/dlm/dlmmaster.c
@@ -2554,8 +2554,6 @@ static int dlm_migrate_lockres(struct dlm_ctxt *dlm,
 	if (!dlm_grab(dlm))
 		return -EINVAL;
 
-	BUG_ON(target == O2NM_MAX_NODES);
-
 	name = res-&gt;lockname.name;
 	namelen = res-&gt;lockname.len;
 </pre><hr><pre>commit b0e4cfae483fe1e3db71ab2d8509490df60e52c6
Author: Aditya Pakki &lt;pakki001@umn.edu&gt;
Date:   Mon Jan 6 15:32:51 2020 +0100

    media: davinci/vpfe_capture.c: Avoid BUG_ON for register failure
    
    In vpfe_register_ccdc_device(), failure to allocate dev-&gt;hw_ops
    fields calls BUG_ON(). This patch returns the error to callers
    instead of crashing. The issue was identified by a static
    analysis tool, written by us.
    
    Signed-off-by: Aditya Pakki &lt;pakki001@umn.edu&gt;
    Signed-off-by: Hans Verkuil &lt;hverkuil-cisco@xs4all.nl&gt;
    Signed-off-by: Mauro Carvalho Chehab &lt;mchehab+huawei@kernel.org&gt;

diff --git a/drivers/media/platform/davinci/vpfe_capture.c b/drivers/media/platform/davinci/vpfe_capture.c
index 916ed743d716..9b1d9643589b 100644
--- a/drivers/media/platform/davinci/vpfe_capture.c
+++ b/drivers/media/platform/davinci/vpfe_capture.c
@@ -168,21 +168,22 @@ int vpfe_register_ccdc_device(const struct ccdc_hw_device *dev)
 	int ret = 0;
 	printk(KERN_NOTICE "vpfe_register_ccdc_device: %s\n", dev-&gt;name);
 
-	BUG_ON(!dev-&gt;hw_ops.open);
-	BUG_ON(!dev-&gt;hw_ops.enable);
-	BUG_ON(!dev-&gt;hw_ops.set_hw_if_params);
-	BUG_ON(!dev-&gt;hw_ops.configure);
-	BUG_ON(!dev-&gt;hw_ops.set_buftype);
-	BUG_ON(!dev-&gt;hw_ops.get_buftype);
-	BUG_ON(!dev-&gt;hw_ops.enum_pix);
-	BUG_ON(!dev-&gt;hw_ops.set_frame_format);
-	BUG_ON(!dev-&gt;hw_ops.get_frame_format);
-	BUG_ON(!dev-&gt;hw_ops.get_pixel_format);
-	BUG_ON(!dev-&gt;hw_ops.set_pixel_format);
-	BUG_ON(!dev-&gt;hw_ops.set_image_window);
-	BUG_ON(!dev-&gt;hw_ops.get_image_window);
-	BUG_ON(!dev-&gt;hw_ops.get_line_length);
-	BUG_ON(!dev-&gt;hw_ops.getfid);
+	if (!dev-&gt;hw_ops.open ||
+	    !dev-&gt;hw_ops.enable ||
+	    !dev-&gt;hw_ops.set_hw_if_params ||
+	    !dev-&gt;hw_ops.configure ||
+	    !dev-&gt;hw_ops.set_buftype ||
+	    !dev-&gt;hw_ops.get_buftype ||
+	    !dev-&gt;hw_ops.enum_pix ||
+	    !dev-&gt;hw_ops.set_frame_format ||
+	    !dev-&gt;hw_ops.get_frame_format ||
+	    !dev-&gt;hw_ops.get_pixel_format ||
+	    !dev-&gt;hw_ops.set_pixel_format ||
+	    !dev-&gt;hw_ops.set_image_window ||
+	    !dev-&gt;hw_ops.get_image_window ||
+	    !dev-&gt;hw_ops.get_line_length ||
+	    !dev-&gt;hw_ops.getfid)
+		return -EINVAL;
 
 	mutex_lock(&amp;ccdc_lock);
 	if (!ccdc_cfg) {</pre><hr><pre>commit 1ec4c6efe23154b4ab44c1a34dbc0eb121eb614a
Author: Aditya Pakki &lt;pakki001@umn.edu&gt;
Date:   Sun Dec 15 20:21:33 2019 +0100

    media: saa7146: Avoid using BUG_ON as an assertion
    
    In video_begin and video_end, saa7146_format_by_fourcc can return
    NULL and is checked via BUG_ON. However, by returning the error
    to the callers upstream, we can avoid the crash and handle it via
    recovery code.
    
    Signed-off-by: Aditya Pakki &lt;pakki001@umn.edu&gt;
    Signed-off-by: Hans Verkuil &lt;hverkuil-cisco@xs4all.nl&gt;
    Signed-off-by: Mauro Carvalho Chehab &lt;mchehab+huawei@kernel.org&gt;

diff --git a/drivers/media/common/saa7146/saa7146_video.c b/drivers/media/common/saa7146/saa7146_video.c
index d16122039b0c..ccd15b4d4920 100644
--- a/drivers/media/common/saa7146/saa7146_video.c
+++ b/drivers/media/common/saa7146/saa7146_video.c
@@ -345,7 +345,8 @@ static int video_begin(struct saa7146_fh *fh)
 
 	fmt = saa7146_format_by_fourcc(dev, vv-&gt;video_fmt.pixelformat);
 	/* we need to have a valid format set here */
-	BUG_ON(NULL == fmt);
+	if (!fmt)
+		return -EINVAL;
 
 	if (0 != (fmt-&gt;flags &amp; FORMAT_IS_PLANAR)) {
 		resource = RESOURCE_DMA1_HPS|RESOURCE_DMA2_CLP|RESOURCE_DMA3_BRS;
@@ -398,7 +399,8 @@ static int video_end(struct saa7146_fh *fh, struct file *file)
 
 	fmt = saa7146_format_by_fourcc(dev, vv-&gt;video_fmt.pixelformat);
 	/* we need to have a valid format set here */
-	BUG_ON(NULL == fmt);
+	if (!fmt)
+		return -EINVAL;
 
 	if (0 != (fmt-&gt;flags &amp; FORMAT_IS_PLANAR)) {
 		resource = RESOURCE_DMA1_HPS|RESOURCE_DMA2_CLP|RESOURCE_DMA3_BRS;</pre><hr><pre>commit 93a24578de721006055b422c7772e0e417e1983c
Author: Aditya Pakki &lt;pakki001@umn.edu&gt;
Date:   Sun Dec 15 20:08:04 2019 +0100

    media: cx231xx: replace BUG_ON with recovery code
    
    In cx231xx_i2c_register, if dev-&gt;cx231xx_send_usb_command is NULL,
    the code crashes. However, the callers in cx231xx-core are able to
    handle the error without crashing. This patch fixes this issue.
    
    Signed-off-by: Aditya Pakki &lt;pakki001@umn.edu&gt;
    Signed-off-by: Hans Verkuil &lt;hverkuil-cisco@xs4all.nl&gt;
    Signed-off-by: Mauro Carvalho Chehab &lt;mchehab+huawei@kernel.org&gt;

diff --git a/drivers/media/usb/cx231xx/cx231xx-i2c.c b/drivers/media/usb/cx231xx/cx231xx-i2c.c
index f33b6a077d57..c6659253c6fb 100644
--- a/drivers/media/usb/cx231xx/cx231xx-i2c.c
+++ b/drivers/media/usb/cx231xx/cx231xx-i2c.c
@@ -515,7 +515,8 @@ int cx231xx_i2c_register(struct cx231xx_i2c *bus)
 {
 	struct cx231xx *dev = bus-&gt;dev;
 
-	BUG_ON(!dev-&gt;cx231xx_send_usb_command);
+	if (!dev-&gt;cx231xx_send_usb_command)
+		return -EINVAL;
 
 	bus-&gt;i2c_adap = cx231xx_adap_template;
 	bus-&gt;i2c_adap.dev.parent = dev-&gt;dev;</pre><hr><pre>commit 9f48db0d4a08624bb9ba847ea40c8abad753b396
Author: Aditya Pakki &lt;pakki001@umn.edu&gt;
Date:   Tue Dec 17 13:44:37 2019 -0600

    RDMA/srpt: Remove unnecessary assertion in srpt_queue_response
    
    Since ch has already been de-referenced by the time we get to the BUG_ON,
    it is useless. The back trace alone is enough to tell what is going on,
    delete the redundant BUG_ON.
    
    Link: https://lore.kernel.org/r/20191217194437.25568-1-pakki001@umn.edu
    Signed-off-by: Aditya Pakki &lt;pakki001@umn.edu&gt;
    Reviewed-by: Bart Van Assche &lt;bvanassche@acm.org&gt;
    Reviewed-by: Jason Gunthorpe &lt;jgg@mellanox.com&gt;
    Signed-off-by: Jason Gunthorpe &lt;jgg@mellanox.com&gt;

diff --git a/drivers/infiniband/ulp/srpt/ib_srpt.c b/drivers/infiniband/ulp/srpt/ib_srpt.c
index 23c782e3d49a..98552749d71c 100644
--- a/drivers/infiniband/ulp/srpt/ib_srpt.c
+++ b/drivers/infiniband/ulp/srpt/ib_srpt.c
@@ -2810,8 +2810,6 @@ static void srpt_queue_response(struct se_cmd *cmd)
 	int resp_len, ret, i;
 	u8 srp_tm_status;
 
-	BUG_ON(!ch);
-
 	state = ioctx-&gt;state;
 	switch (state) {
 	case SRPT_STATE_NEW:</pre><hr><pre>commit d7a336d67ab5443a0ef14b8335d139e855e8a682
Author: Aditya Pakki &lt;pakki001@umn.edu&gt;
Date:   Thu Dec 19 11:21:11 2019 -0600

    staging: kpc2000: remove unnecessary assertions in kpc_dma_transfer
    
    In kpc_dma_transfer(), the assertion that priv is NULL and priv-&gt;ldev
    is NULL, are never satisfied. The two callers of the function,
    dereference the fields before the function is called. This patch
    removes the two BUG_ON calls.
    
    Signed-off-by: Aditya Pakki &lt;pakki001@umn.edu&gt;
    Link: https://lore.kernel.org/r/20191219172118.17456-1-pakki001@umn.edu
    Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

diff --git a/drivers/staging/kpc2000/kpc_dma/fileops.c b/drivers/staging/kpc2000/kpc_dma/fileops.c
index cb52bd9a6d2f..40525540dde6 100644
--- a/drivers/staging/kpc2000/kpc_dma/fileops.c
+++ b/drivers/staging/kpc2000/kpc_dma/fileops.c
@@ -49,9 +49,7 @@ static int kpc_dma_transfer(struct dev_private_data *priv,
 	u64 dma_addr;
 	u64 user_ctl;
 
-	BUG_ON(priv == NULL);
 	ldev = priv-&gt;ldev;
-	BUG_ON(ldev == NULL);
 
 	acd = kzalloc(sizeof(*acd), GFP_KERNEL);
 	if (!acd) {</pre><hr><pre>commit d6bd6cf9feb81737f9f64d2c1acf98fdaacebad1
Author: Aditya Pakki &lt;pakki001@umn.edu&gt;
Date:   Tue Dec 17 14:53:56 2019 -0600

    xen/grant-table: remove multiple BUG_ON on gnttab_interface
    
    gnttab_request_version() always sets the gnttab_interface variable
    and the assertions to check for empty gnttab_interface is unnecessary.
    The patch eliminates multiple such assertions.
    
    Signed-off-by: Aditya Pakki &lt;pakki001@umn.edu&gt;
    Reviewed-by: Juergen Gross &lt;jgross@suse.com&gt;
    Signed-off-by: Juergen Gross &lt;jgross@suse.com&gt;

diff --git a/drivers/xen/grant-table.c b/drivers/xen/grant-table.c
index 49b381e104ef..7b36b51cdb9f 100644
--- a/drivers/xen/grant-table.c
+++ b/drivers/xen/grant-table.c
@@ -664,7 +664,6 @@ static int grow_gnttab_list(unsigned int more_frames)
 	unsigned int nr_glist_frames, new_nr_glist_frames;
 	unsigned int grefs_per_frame;
 
-	BUG_ON(gnttab_interface == NULL);
 	grefs_per_frame = gnttab_interface-&gt;grefs_per_grant_frame;
 
 	new_nr_grant_frames = nr_grant_frames + more_frames;
@@ -1160,7 +1159,6 @@ EXPORT_SYMBOL_GPL(gnttab_unmap_refs_sync);
 
 static unsigned int nr_status_frames(unsigned int nr_grant_frames)
 {
-	BUG_ON(gnttab_interface == NULL);
 	return gnttab_frames(nr_grant_frames, SPP);
 }
 
@@ -1388,7 +1386,6 @@ static int gnttab_expand(unsigned int req_entries)
 	int rc;
 	unsigned int cur, extra;
 
-	BUG_ON(gnttab_interface == NULL);
 	cur = nr_grant_frames;
 	extra = ((req_entries + gnttab_interface-&gt;grefs_per_grant_frame - 1) /
 		 gnttab_interface-&gt;grefs_per_grant_frame);
@@ -1423,7 +1420,6 @@ int gnttab_init(void)
 	/* Determine the maximum number of frames required for the
 	 * grant reference free list on the current hypervisor.
 	 */
-	BUG_ON(gnttab_interface == NULL);
 	max_nr_glist_frames = (max_nr_grant_frames *
 			       gnttab_interface-&gt;grefs_per_grant_frame / RPP);
 </pre><hr><pre>commit 52b894393cecdc303990e834778d39b85d0553fc
Author: Aditya Pakki &lt;pakki001@umn.edu&gt;
Date:   Tue Dec 17 15:22:13 2019 -0600

    scsi: libfc: remove unnecessary assertion on ep variable
    
    In ft_recv_write_data(), the pointer ep is dereferenced first and then
    asserts for NULL. The patch removes the unnecessary assertion.
    
    Link: https://lore.kernel.org/r/20191217212214.30722-1-pakki001@umn.edu
    Reviewed-by: Hannes Reinecke &lt;hare@suse.de&gt;
    Signed-off-by: Aditya Pakki &lt;pakki001@umn.edu&gt;
    Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;

diff --git a/drivers/target/tcm_fc/tfc_io.c b/drivers/target/tcm_fc/tfc_io.c
index 1354a157e9af..6a38ff936389 100644
--- a/drivers/target/tcm_fc/tfc_io.c
+++ b/drivers/target/tcm_fc/tfc_io.c
@@ -221,7 +221,6 @@ void ft_recv_write_data(struct ft_cmd *cmd, struct fc_frame *fp)
 	ep = fc_seq_exch(seq);
 	lport = ep-&gt;lp;
 	if (cmd-&gt;was_ddp_setup) {
-		BUG_ON(!ep);
 		BUG_ON(!lport);
 		/*
 		 * Since DDP (Large Rx offload) was setup for this request,</pre><hr><pre>commit a886ca6fcfffd337482352f383c1002c72786b17
Author: Aditya Pakki &lt;pakki001@umn.edu&gt;
Date:   Tue Dec 17 15:06:19 2019 -0600

    hdlcdrv: replace unnecessary assertion in hdlcdrv_register
    
    In hdlcdrv_register, failure to register the driver causes a crash.
    The three callers of hdlcdrv_register all pass valid pointers and
    do not fail. The patch eliminates the unnecessary BUG_ON assertion.
    
    Signed-off-by: Aditya Pakki &lt;pakki001@umn.edu&gt;
    Signed-off-by: David S. Miller &lt;davem@davemloft.net&gt;

diff --git a/drivers/net/hamradio/hdlcdrv.c b/drivers/net/hamradio/hdlcdrv.c
index df495b5595f5..e7413a643929 100644
--- a/drivers/net/hamradio/hdlcdrv.c
+++ b/drivers/net/hamradio/hdlcdrv.c
@@ -687,8 +687,6 @@ struct net_device *hdlcdrv_register(const struct hdlcdrv_ops *ops,
 	struct hdlcdrv_state *s;
 	int err;
 
-	BUG_ON(ops == NULL);
-
 	if (privsize &lt; sizeof(struct hdlcdrv_state))
 		privsize = sizeof(struct hdlcdrv_state);
 </pre><hr><pre>commit 615f22f58029aa747b12768985e7f91cd053daa2
Author: Aditya Pakki &lt;pakki001@umn.edu&gt;
Date:   Tue Dec 17 14:43:00 2019 -0600

    nfc: s3fwrn5: replace the assertion with a WARN_ON
    
    In s3fwrn5_fw_recv_frame, if fw_info-&gt;rsp is not empty, the
    current code causes a crash via BUG_ON. However, s3fwrn5_fw_send_msg
    does not crash in such a scenario. The patch replaces the BUG_ON
    by returning the error to the callers and frees up skb.
    
    Signed-off-by: Aditya Pakki &lt;pakki001@umn.edu&gt;
    Signed-off-by: David S. Miller &lt;davem@davemloft.net&gt;

diff --git a/drivers/nfc/s3fwrn5/firmware.c b/drivers/nfc/s3fwrn5/firmware.c
index be110d9cef02..de613c623a2c 100644
--- a/drivers/nfc/s3fwrn5/firmware.c
+++ b/drivers/nfc/s3fwrn5/firmware.c
@@ -507,7 +507,10 @@ int s3fwrn5_fw_recv_frame(struct nci_dev *ndev, struct sk_buff *skb)
 	struct s3fwrn5_info *info = nci_get_drvdata(ndev);
 	struct s3fwrn5_fw_info *fw_info = &amp;info-&gt;fw_info;
 
-	BUG_ON(fw_info-&gt;rsp);
+	if (WARN_ON(fw_info-&gt;rsp)) {
+		kfree_skb(skb);
+		return -EINVAL;
+	}
 
 	fw_info-&gt;rsp = skb;
 </pre>
    <div class="pagination">
        <a href='7_8.html'>&lt;&lt;Prev</a><a href='7.html'>1</a><a href='7_2.html'>2</a><a href='7_3.html'>3</a><a href='7_4.html'>4</a><a href='7_5.html'>5</a><a href='7_6.html'>6</a><a href='7_7.html'>7</a><a href='7_8.html'>8</a><span>[9]</span><a href='7_10.html'>10</a><a href='7_11.html'>11</a><a href='7_12.html'>12</a><a href='7_13.html'>13</a><a href='7_14.html'>14</a><a href='7_15.html'>15</a><a href='7_16.html'>16</a><a href='7_17.html'>17</a><a href='7_18.html'>18</a><a href='7_19.html'>19</a><a href='7_20.html'>20</a><a href='7_21.html'>21</a><a href='7_22.html'>22</a><a href='7_23.html'>23</a><a href='7_24.html'>24</a><a href='7_25.html'>25</a><a href='7_26.html'>26</a><a href='7_27.html'>27</a><a href='7_28.html'>28</a><a href='7_29.html'>29</a><a href='7_30.html'>30</a><a href='7_10.html'>Next&gt;&gt;</a>
    <div>
</body>
