<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patches contributed by Virginia Tech</title>
    <style>
    .pagination {
        border-top: 1px solid #ddd;
        border-bottom: 1px solid #ddd;
        overflow-wrap: break-word;
    }
    .pagination a, .pagination span {
        margin: 0 4px;
    }

    </style>
</head>
<body>
    <h1>Patches contributed by Virginia Tech</h1>
    <div class="pagination">
        <a href='10_8.html'>&lt;&lt;Prev</a><a href='10.html'>1</a><a href='10_2.html'>2</a><a href='10_3.html'>3</a><a href='10_4.html'>4</a><a href='10_5.html'>5</a><a href='10_6.html'>6</a><a href='10_7.html'>7</a><a href='10_8.html'>8</a><span>[9]</span><a href='10_10.html'>10</a><a href='10_11.html'>11</a><a href='10_12.html'>12</a><a href='10_10.html'>Next&gt;&gt;</a>
    </div>
    <hr>
    <pre>commit 80d172431696482d9acd8d2c4ea78fed8956e2a1
Author: Valdis Kletnieks &lt;valdis.kletnieks@vt.edu&gt;
Date:   Sun Feb 4 12:01:43 2018 -0500

    gcc-plugins: Add include required by GCC release 8
    
    GCC requires another #include to get the gcc-plugins to build cleanly.
    
    Signed-off-by: Valdis Kletnieks &lt;valdis.kletnieks@vt.edu&gt;
    Signed-off-by: Kees Cook &lt;keescook@chromium.org&gt;

diff --git a/scripts/gcc-plugins/gcc-common.h b/scripts/gcc-plugins/gcc-common.h
index ffd1dfaa1cc1..f46750053377 100644
--- a/scripts/gcc-plugins/gcc-common.h
+++ b/scripts/gcc-plugins/gcc-common.h
@@ -97,6 +97,10 @@
 #include "predict.h"
 #include "ipa-utils.h"
 
+#if BUILDING_GCC_VERSION &gt;= 8000
+#include "stringpool.h"
+#endif
+
 #if BUILDING_GCC_VERSION &gt;= 4009
 #include "attribs.h"
 #include "varasm.h"</pre><hr><pre>commit 0da325afbdb80098e014b83937372e3eef6872d5
Author: Valdis Kletnieks &lt;Valdis.Kletnieks@vt.edu&gt;
Date:   Tue Sep 20 18:14:53 2016 -0400

    ALSA: line6: snd-usb-line6 depends on CONFIG_SND_HWDEP
    
    ERROR: "snd_hwdep_new" [sound/usb/line6/snd-usb-line6.ko] undefined!
    scripts/Makefile.modpost:91: recipe for target '__modpost' failed
    make[1]: *** [__modpost] Error 1
    
    Fixes: a16039cbf1a1 ('ALSA: line6: Add hwdep interface to access the POD control messages')
    Signed-off-by: Valdis Kletnieks &lt;valdis.kletnieks@vt.edu&gt;
    Reviewed-by: Takashi Sakamoto &lt;o-takashi@sakamocchi.jp&gt;
    Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;

diff --git a/sound/usb/line6/Kconfig b/sound/usb/line6/Kconfig
index 8ffcf48097d9..39b400392d71 100644
--- a/sound/usb/line6/Kconfig
+++ b/sound/usb/line6/Kconfig
@@ -2,6 +2,7 @@ config SND_USB_LINE6
 	tristate
 	select SND_RAWMIDI
 	select SND_PCM
+	select SND_HWDEP
 
 config SND_USB_POD
 	tristate "Line 6 POD USB support"</pre><hr><pre>commit 5e44258d168b2bdee51d9e2e1f1f4726ff9775cd
Author: Valdis Kletnieks &lt;Valdis.Kletnieks@vt.edu&gt;
Date:   Sun Jul 31 23:24:50 2016 -0400

    x86/build: Reduce the W=1 warnings noise when compiling x86 syscall tables
    
    Building an X86_64 kernel with W=1 throws a total of 9,948 lines of warnings of
    this form for both 32-bit and 64-bit syscall tables. Given that the entire rest
    of the build for my config only generates 8,375 lines of output, this is a big
    reduction in the warnings generated.
    
    The warnings follow this pattern:
    
      ./arch/x86/include/generated/asm/syscalls_32.h:885:21: warning: initialized field overwritten [-Woverride-init]
       __SYSCALL_I386(379, compat_sys_pwritev2, )
                         ^
      arch/x86/entry/syscall_32.c:13:46: note: in definition of macro '__SYSCALL_I386'
       #define __SYSCALL_I386(nr, sym, qual) [nr] = sym,
                                                  ^~~
      ./arch/x86/include/generated/asm/syscalls_32.h:885:21: note: (near initialization for 'ia32_sys_call_table[379]')
       __SYSCALL_I386(379, compat_sys_pwritev2, )
                         ^
      arch/x86/entry/syscall_32.c:13:46: note: in definition of macro '__SYSCALL_I386'
       #define __SYSCALL_I386(nr, sym, qual) [nr] = sym,
    
    Since we intentionally build the syscall tables this way, ignore that one
    warning in the two files.
    
    Signed-off-by: Valdis Kletnieks &lt;valdis.kletnieks@vt.edu&gt;
    Cc: Andy Lutomirski &lt;luto@kernel.org&gt;
    Cc: Borislav Petkov &lt;bp@alien8.de&gt;
    Cc: Brian Gerst &lt;brgerst@gmail.com&gt;
    Cc: Denys Vlasenko &lt;dvlasenk@redhat.com&gt;
    Cc: H. Peter Anvin &lt;hpa@zytor.com&gt;
    Cc: Josh Poimboeuf &lt;jpoimboe@redhat.com&gt;
    Cc: Linus Torvalds &lt;torvalds@linux-foundation.org&gt;
    Cc: Peter Zijlstra &lt;peterz@infradead.org&gt;
    Cc: Thomas Gleixner &lt;tglx@linutronix.de&gt;
    Link: http://lkml.kernel.org/r/7464.1470021890@turing-police.cc.vt.edu
    Signed-off-by: Ingo Molnar &lt;mingo@kernel.org&gt;

diff --git a/arch/x86/entry/Makefile b/arch/x86/entry/Makefile
index fe91c25092da..77f28ce9c646 100644
--- a/arch/x86/entry/Makefile
+++ b/arch/x86/entry/Makefile
@@ -5,6 +5,8 @@
 OBJECT_FILES_NON_STANDARD_entry_$(BITS).o   := y
 OBJECT_FILES_NON_STANDARD_entry_64_compat.o := y
 
+CFLAGS_syscall_64.o		+= -Wno-override-init
+CFLAGS_syscall_32.o		+= -Wno-override-init
 obj-y				:= entry_$(BITS).o thunk_$(BITS).o syscall_$(BITS).o
 obj-y				+= common.o
 </pre><hr><pre>commit f1cb637e75b59a07450cf81ad68b04f3f46b03d7
Author: Valdis Kletnieks &lt;Valdis.Kletnieks@vt.edu&gt;
Date:   Tue Aug 2 14:07:27 2016 -0700

    init/Kconfig: add clarification for out-of-tree modules
    
    It doesn't trim just symbols that are totally unused in-tree - it trims
    the symbols unused by any in-tree modules actually built.  If you've
    done a 'make localmodconfig' and only build a hundred or so modules,
    it's pretty likely that your out-of-tree module will come up lacking
    something...
    
    Hopefully this will save the next guy from a Homer Simpson "D'oh!"
    moment.
    
    Link: http://lkml.kernel.org/r/10177.1469787292@turing-police.cc.vt.edu
    Signed-off-by: Valdis Kletnieks &lt;valdis.kletnieks@vt.edu&gt;
    Cc: Michal Marek &lt;mmarek@suse.cz&gt;
    Cc: Rusty Russell &lt;rusty@rustcorp.com.au&gt;
    Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    Signed-off-by: Linus Torvalds &lt;torvalds@linux-foundation.org&gt;

diff --git a/init/Kconfig b/init/Kconfig
index 380798f86aae..69886493ff1e 100644
--- a/init/Kconfig
+++ b/init/Kconfig
@@ -2080,7 +2080,7 @@ config TRIM_UNUSED_KSYMS
 	  (especially when using LTO) for optimizing the code and reducing
 	  binary size.  This might have some security advantages as well.
 
-	  If unsure say N.
+	  If unsure, or if you need to build out-of-tree modules, say N.
 
 endif # MODULES
 </pre><hr><pre>commit ca52953f5f24aff0aa8fa8de750b76ba0302142d
Author: Valdis Kletnieks &lt;Valdis.Kletnieks@vt.edu&gt;
Date:   Tue Aug 2 14:03:25 2016 -0700

    fs/proc/task_mmu.c: suppress compilation warnings with W=1
    
    Suppress a bunch of warnings of the form:
    
      fs/proc/task_mmu.c: In function 'show_smap_vma_flags':
      fs/proc/task_mmu.c:635:22: warning: initialized field overwritten [-Wt override-init]
         [ilog2(VM_READ)] = "rd",
                            ^~~~
      fs/proc/task_mmu.c:635:22: note: (near initialization for 'mnemonics[0]')
    
    They happen because of the way we intentionally build the table, so
    silence the warning when building with 'make W=1'.
    
    Link: http://lkml.kernel.org/r/8727.1470022083@turing-police.cc.vt.edu
    Signed-off-by: Valdis Kletnieks &lt;valdis.kletnieks@vt.edu&gt;
    Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    Signed-off-by: Linus Torvalds &lt;torvalds@linux-foundation.org&gt;

diff --git a/fs/proc/Makefile b/fs/proc/Makefile
index 7151ea428041..a8c13605b434 100644
--- a/fs/proc/Makefile
+++ b/fs/proc/Makefile
@@ -4,6 +4,7 @@
 
 obj-y   += proc.o
 
+CFLAGS_task_mmu.o	+= -Wno-override-init
 proc-y			:= nommu.o task_nommu.o
 proc-$(CONFIG_MMU)	:= task_mmu.o
 </pre><hr><pre>commit 117dec978cf64e8e96f13d0cf4891ff77c9acf55
Author: Valdis Kletnieks &lt;Valdis.Kletnieks@vt.edu&gt;
Date:   Tue Aug 2 14:02:28 2016 -0700

    tools/testing/radix-tree/linux/gfp.h: fix bitrotted value
    
    Apparently, the tools/testing version dates to a few flags ago, and
    we've sprouted 4 new ones since.  Keep in sync with the value in the
    main tree...
    
    Link: http://lkml.kernel.org/r/23400.1469702675@turing-police.cc.vt.edu
    Signed-off-by: Valdis Kletnieks &lt;valdis.kletnieks@vt.edu&gt;
    Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    Signed-off-by: Linus Torvalds &lt;torvalds@linux-foundation.org&gt;

diff --git a/tools/testing/radix-tree/linux/gfp.h b/tools/testing/radix-tree/linux/gfp.h
index 0e37f7a760eb..5201b915f631 100644
--- a/tools/testing/radix-tree/linux/gfp.h
+++ b/tools/testing/radix-tree/linux/gfp.h
@@ -1,7 +1,7 @@
 #ifndef _GFP_H
 #define _GFP_H
 
-#define __GFP_BITS_SHIFT 22
+#define __GFP_BITS_SHIFT 26
 #define __GFP_BITS_MASK ((gfp_t)((1 &lt;&lt; __GFP_BITS_SHIFT) - 1))
 #define __GFP_WAIT 1
 #define __GFP_ACCOUNT 0</pre><hr><pre>commit c67f69576bba438e69f3d0657e08bdecb4cc2097
Author: Valdis Kletnieks &lt;Valdis.Kletnieks@vt.edu&gt;
Date:   Mon May 30 02:26:38 2016 -0400

    Fix annoyingly awkward typo in drm_edid_load.c
    
    Fix egregious typo in comment.
    
    Signed-off-by: Valdis Kletnieks &lt;valdis.kletnieks@vt.edu&gt;
    Signed-off-by: Daniel Vetter &lt;daniel.vetter@ffwll.ch&gt;
    Link: http://patchwork.freedesktop.org/patch/msgid/10576.1464589598@turing-police.cc.vt.edu

diff --git a/drivers/gpu/drm/drm_edid_load.c b/drivers/gpu/drm/drm_edid_load.c
index 9a401aed98e0..622f788bff46 100644
--- a/drivers/gpu/drm/drm_edid_load.c
+++ b/drivers/gpu/drm/drm_edid_load.c
@@ -271,7 +271,7 @@ int drm_load_edid_firmware(struct drm_connector *connector)
 	 * by commas, search through the list looking for one that
 	 * matches the connector.
 	 *
-	 * If there's one or more that don't't specify a connector, keep
+	 * If there's one or more that doesn't specify a connector, keep
 	 * the last one found one as a fallback.
 	 */
 	fwstr = kstrdup(edid_firmware, GFP_KERNEL);</pre><hr><pre>commit ad0d7799382b37e6afa910f27fa342af62d80ded
Author: Valdis Kletnieks &lt;Valdis.Kletnieks@vt.edu&gt;
Date:   Tue Dec 22 19:36:54 2015 -0500

    drivers/staging/lustre: Nuke another unsigned &gt;= 0 assert
    
    Clean up another case of the compiler remininding the programmer they
    are an idiot:
    
    drivers/staging/lustre/lustre/ptlrpc/sec_bulk.c:308:34: warning: comparison of unsigned expression &gt;= 0 is always true [-Wtype-limits]
      LASSERT(page_pools.epp_waitqlen &gt;= 0);
    
    Just lose the assert, and save a page of compiler spew.
    
    Signed-off-by: Valdis Kletnieks &lt;Valdis.Kletnieks@vt.edu&gt;
    Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

diff --git a/drivers/staging/lustre/lustre/ptlrpc/sec_bulk.c b/drivers/staging/lustre/lustre/ptlrpc/sec_bulk.c
index 6152c1b766c3..22621c74a66a 100644
--- a/drivers/staging/lustre/lustre/ptlrpc/sec_bulk.c
+++ b/drivers/staging/lustre/lustre/ptlrpc/sec_bulk.c
@@ -304,7 +304,6 @@ static unsigned long enc_pools_cleanup(struct page ***pools, int npools)
 static inline void enc_pools_wakeup(void)
 {
 	assert_spin_locked(&amp;page_pools.epp_lock);
-	LASSERT(page_pools.epp_waitqlen &gt;= 0);
 
 	if (unlikely(page_pools.epp_waitqlen)) {
 		LASSERT(waitqueue_active(&amp;page_pools.epp_waitq));</pre><hr><pre>commit bd6455de1a1af6b382b9ee93311397284c165c92
Author: Valdis Kletnieks &lt;Valdis.Kletnieks@vt.edu&gt;
Date:   Tue Dec 22 19:36:53 2015 -0500

    drivers/staging/lustre: Nuke an unsigned &gt;= 0 assert
    
    Writing asserts for almost-never-can-happen things can be valuable.
    Writing an assert that tests that an "unsigned int" hasn't gone negative
    isn't.
    
    And it generates an *ugly* message:
    
    drivers/staging/lustre/lustre/llite/rw.c:763:20: warning: comparison of unsigned expression &gt;= 0 is always true [-Wtype-limits]
      LASSERTF(reserved &gt;= 0, "reserved %lu\n", reserved);
                        ^
    include/linux/compiler.h:137:45: note: in definition of macro 'unlikely'
     #  define unlikely(x) (__builtin_constant_p(x) ? !!(x) : __branch_check__(x, 0))
                                                 ^
    drivers/staging/lustre/lustre/llite/rw.c:763:2: note: in expansion of macro 'LASSERTF'
      LASSERTF(reserved &gt;= 0, "reserved %lu\n", reserved);
      ^
    drivers/staging/lustre/lustre/llite/rw.c:763:20: warning: comparison of unsigned expression &gt;= 0 is always true [-Wtype-limits]
      LASSERTF(reserved &gt;= 0, "reserved %lu\n", reserved);
                        ^
    include/linux/compiler.h:137:53: note: in definition of macro 'unlikely'
     #  define unlikely(x) (__builtin_constant_p(x) ? !!(x) : __branch_check__(x, 0))
                                                         ^
    drivers/staging/lustre/lustre/llite/rw.c:763:2: note: in expansion of macro 'LASSERTF'
      LASSERTF(reserved &gt;= 0, "reserved %lu\n", reserved);
      ^
    drivers/staging/lustre/lustre/llite/rw.c:763:20: warning: comparison of unsigned expression &gt;= 0 is always true [-Wtype-limits]
      LASSERTF(reserved &gt;= 0, "reserved %lu\n", reserved);
                        ^
    include/linux/compiler.h:110:47: note: in definition of macro 'likely_notrace'
     #define likely_notrace(x) __builtin_expect(!!(x), 1)
                                                   ^
    include/linux/compiler.h:137:58: note: in expansion of macro '__branch_check__'
     #  define unlikely(x) (__builtin_constant_p(x) ? !!(x) : __branch_check__(x, 0))
                                                              ^
    drivers/staging/lustre/lustre/llite/../include/linux/../../../include/linux/libcfs/libcfs_private.h:58:6: note: in expansion of macro 'unlikely'
      if (unlikely(!(cond))) {     \
          ^
    drivers/staging/lustre/lustre/llite/rw.c:763:2: note: in expansion of macro 'LASSERTF'
      LASSERTF(reserved &gt;= 0, "reserved %lu\n", reserved);
      ^
    
    Umm, thank you, GCC.  We'll delete the problem line so we never see that spew again.
    
    Signed-off-by: Valdis Kletnieks &lt;Valdis.Kletnieks@vt.edu&gt;
    Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

diff --git a/drivers/staging/lustre/lustre/llite/rw.c b/drivers/staging/lustre/lustre/llite/rw.c
index f355474967d6..6b587d66d1b3 100644
--- a/drivers/staging/lustre/lustre/llite/rw.c
+++ b/drivers/staging/lustre/lustre/llite/rw.c
@@ -764,7 +764,6 @@ int ll_readahead(const struct lu_env *env, struct cl_io *io,
 	ret = ll_read_ahead_pages(env, io, queue,
 				  ria, &amp;reserved, mapping, &amp;ra_end);
 
-	LASSERTF(reserved &gt;= 0, "reserved %lu\n", reserved);
 	if (reserved != 0)
 		ll_ra_count_put(ll_i2sbi(inode), reserved);
 </pre><hr><pre>commit 5aec2e0791a5a76bec020b088a8b8a10afcfd522
Author: Valdis Kletnieks &lt;Valdis.Kletnieks@vt.edu&gt;
Date:   Tue Dec 22 19:36:52 2015 -0500

    drivers/staging/lustre: Fix another C compiler whine: set but not used
    
      CC [M]  drivers/staging/lustre/lustre/libcfs/module.o
    drivers/staging/lustre/lustre/libcfs/module.c: In function 'lustre_insert_debugfs':
    drivers/staging/lustre/lustre/libcfs/module.c:670:17: warning: variable 'entry' set but not used [-Wunused-but-set-variable]
      struct dentry *entry;
                         ^
    
    Just ignore the dentry returned, and add a comment that we *know*
    we're not really leaking the dentry because something else will be able
    to reap it via recursion.
    
    Signed-off-by: Valdis Kletnieks &lt;Valdis.Kletnieks@vt.edu&gt;
    Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

diff --git a/drivers/staging/lustre/lustre/libcfs/module.c b/drivers/staging/lustre/lustre/libcfs/module.c
index 0067e5347884..af516a29c20e 100644
--- a/drivers/staging/lustre/lustre/libcfs/module.c
+++ b/drivers/staging/lustre/lustre/libcfs/module.c
@@ -511,8 +511,6 @@ static const struct file_operations lnet_debugfs_file_operations = {
 void lustre_insert_debugfs(struct ctl_table *table,
 			   const struct lnet_debugfs_symlink_def *symlinks)
 {
-	struct dentry *entry;
-
 	if (lnet_debugfs_root == NULL)
 		lnet_debugfs_root = debugfs_create_dir("lnet", NULL);
 
@@ -520,15 +518,17 @@ void lustre_insert_debugfs(struct ctl_table *table,
 	if (IS_ERR_OR_NULL(lnet_debugfs_root))
 		return;
 
+	/* We don't save the dentry returned in next two calls, because
+	 * we don't call debugfs_remove() but rather remove_recursive()
+	 */
 	for (; table-&gt;procname; table++)
-		entry = debugfs_create_file(table-&gt;procname, table-&gt;mode,
-					    lnet_debugfs_root, table,
-					    &amp;lnet_debugfs_file_operations);
+		debugfs_create_file(table-&gt;procname, table-&gt;mode,
+				    lnet_debugfs_root, table,
+				    &amp;lnet_debugfs_file_operations);
 
 	for (; symlinks &amp;&amp; symlinks-&gt;name; symlinks++)
-		entry = debugfs_create_symlink(symlinks-&gt;name,
-					       lnet_debugfs_root,
-					       symlinks-&gt;target);
+		debugfs_create_symlink(symlinks-&gt;name, lnet_debugfs_root,
+				       symlinks-&gt;target);
 
 }
 EXPORT_SYMBOL_GPL(lustre_insert_debugfs);</pre>
    <div class="pagination">
        <a href='10_8.html'>&lt;&lt;Prev</a><a href='10.html'>1</a><a href='10_2.html'>2</a><a href='10_3.html'>3</a><a href='10_4.html'>4</a><a href='10_5.html'>5</a><a href='10_6.html'>6</a><a href='10_7.html'>7</a><a href='10_8.html'>8</a><span>[9]</span><a href='10_10.html'>10</a><a href='10_11.html'>11</a><a href='10_12.html'>12</a><a href='10_10.html'>Next&gt;&gt;</a>
    <div>
</body>
