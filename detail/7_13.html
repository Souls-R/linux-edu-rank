<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patches contributed by University of Minnesota</title>
    <style>
    .pagination {
        border-top: 1px solid #ddd;
        border-bottom: 1px solid #ddd;
        overflow-wrap: break-word;
    }
    .pagination a, .pagination span {
        margin: 0 4px;
    }

    </style>
</head>
<body>
    <h1>Patches contributed by University of Minnesota</h1>
    <div class="pagination">
        <a href='7_12.html'>&lt;&lt;Prev</a><a href='7.html'>1</a><a href='7_2.html'>2</a><a href='7_3.html'>3</a><a href='7_4.html'>4</a><a href='7_5.html'>5</a><a href='7_6.html'>6</a><a href='7_7.html'>7</a><a href='7_8.html'>8</a><a href='7_9.html'>9</a><a href='7_10.html'>10</a><a href='7_11.html'>11</a><a href='7_12.html'>12</a><span>[13]</span><a href='7_14.html'>14</a><a href='7_15.html'>15</a><a href='7_16.html'>16</a><a href='7_17.html'>17</a><a href='7_18.html'>18</a><a href='7_19.html'>19</a><a href='7_20.html'>20</a><a href='7_21.html'>21</a><a href='7_22.html'>22</a><a href='7_23.html'>23</a><a href='7_24.html'>24</a><a href='7_25.html'>25</a><a href='7_26.html'>26</a><a href='7_27.html'>27</a><a href='7_28.html'>28</a><a href='7_29.html'>29</a><a href='7_30.html'>30</a><a href='7_14.html'>Next&gt;&gt;</a>
    </div>
    <hr>
    <pre>commit 39416c5872db69859e867fa250b9cbb3f1e0d185
Author: Wenwen Wang &lt;wang6495@umn.edu&gt;
Date:   Mon Apr 15 12:58:06 2019 -0500

    udf: fix an uninitialized read bug and remove dead code
    
    In udf_lookup(), the pointer 'fi' is a local variable initialized by the
    return value of the function call udf_find_entry(). However, if the macro
    'UDF_RECOVERY' is defined, this variable will become uninitialized if the
    else branch is not taken, which can potentially cause incorrect results in
    the following execution.
    
    To fix this issue, this patch drops the whole code in the ifdef
    'UDF_RECOVERY' region, as it is dead code.
    
    Signed-off-by: Wenwen Wang &lt;wang6495@umn.edu&gt;
    Signed-off-by: Jan Kara &lt;jack@suse.cz&gt;

diff --git a/fs/udf/namei.c b/fs/udf/namei.c
index 58cc2414992b..77b6d89b9bcd 100644
--- a/fs/udf/namei.c
+++ b/fs/udf/namei.c
@@ -304,21 +304,6 @@ static struct dentry *udf_lookup(struct inode *dir, struct dentry *dentry,
 	if (dentry-&gt;d_name.len &gt; UDF_NAME_LEN)
 		return ERR_PTR(-ENAMETOOLONG);
 
-#ifdef UDF_RECOVERY
-	/* temporary shorthand for specifying files by inode number */
-	if (!strncmp(dentry-&gt;d_name.name, ".B=", 3)) {
-		struct kernel_lb_addr lb = {
-			.logicalBlockNum = 0,
-			.partitionReferenceNum =
-				simple_strtoul(dentry-&gt;d_name.name + 3,
-						NULL, 0),
-		};
-		inode = udf_iget(dir-&gt;i_sb, lb);
-		if (IS_ERR(inode))
-			return inode;
-	} else
-#endif /* UDF_RECOVERY */
-
 	fi = udf_find_entry(dir, &amp;dentry-&gt;d_name, &amp;fibh, &amp;cfi);
 	if (IS_ERR(fi))
 		return ERR_CAST(fi);</pre><hr><pre>commit 611025983b7976df0183390a63a2166411d177f1
Author: Kangjie Lu &lt;kjlu@umn.edu&gt;
Date:   Mon Mar 11 00:53:33 2019 -0500

    mmc_spi: add a status check for spi_sync_locked
    
    In case spi_sync_locked fails, the fix reports the error and
    returns the error code upstream.
    
    Signed-off-by: Kangjie Lu &lt;kjlu@umn.edu&gt;
    Reviewed-by: Laurent Pinchart &lt;laurent.pinchart@ideasonboard.com&gt;
    Signed-off-by: Ulf Hansson &lt;ulf.hansson@linaro.org&gt;

diff --git a/drivers/mmc/host/mmc_spi.c b/drivers/mmc/host/mmc_spi.c
index 1b1498805972..a3533935e282 100644
--- a/drivers/mmc/host/mmc_spi.c
+++ b/drivers/mmc/host/mmc_spi.c
@@ -819,6 +819,10 @@ mmc_spi_readblock(struct mmc_spi_host *host, struct spi_transfer *t,
 	}
 
 	status = spi_sync_locked(spi, &amp;host-&gt;m);
+	if (status &lt; 0) {
+		dev_dbg(&amp;spi-&gt;dev, "read error %d\n", status);
+		return status;
+	}
 
 	if (host-&gt;dma_dev) {
 		dma_sync_single_for_cpu(host-&gt;dma_dev,</pre><hr><pre>commit d9350f21e5fe2614e1f78ef20c3a3e83c4a36391
Author: Aditya Pakki &lt;pakki001@umn.edu&gt;
Date:   Fri Mar 22 16:55:03 2019 -0500

    firmware: arm_scmi: replace of_match_device-&gt;data with of_device_get_match_data()
    
    of_match_device can return NULL if no matching device is found though
    it's highly unlikely to happen in scmi_probe as it's called only if
    a valid match is found.
    
    However we can use of_device_get_match_data() instead of
    of_match_device()-&gt;data to handle NULL pointer checks and return -EINVAL
    in such a scenario.
    
    Reviewed-by: Steven Price &lt;steven.price@arm.com&gt;
    Signed-off-by: Aditya Pakki &lt;pakki001@umn.edu&gt;
    Signed-off-by: Sudeep Holla &lt;sudeep.holla@arm.com&gt;

diff --git a/drivers/firmware/arm_scmi/driver.c b/drivers/firmware/arm_scmi/driver.c
index dd967d675c08..b5bc4c7a8fab 100644
--- a/drivers/firmware/arm_scmi/driver.c
+++ b/drivers/firmware/arm_scmi/driver.c
@@ -796,7 +796,9 @@ static int scmi_probe(struct platform_device *pdev)
 		return -EINVAL;
 	}
 
-	desc = of_match_device(scmi_of_match, dev)-&gt;data;
+	desc = of_device_get_match_data(dev);
+	if (!desc)
+		return -EINVAL;
 
 	info = devm_kzalloc(dev, sizeof(*info), GFP_KERNEL);
 	if (!info)</pre><hr><pre>commit 507b820009a457afa78202da337bcb56791fbb12
Author: Kangjie Lu &lt;kjlu@umn.edu&gt;
Date:   Fri Mar 15 00:07:10 2019 -0500

    PCI: endpoint: Fix a potential NULL pointer dereference
    
    In case alloc_workqueue() fails, return -ENOMEM to avoid
    potential NULL pointer dereferences.
    
    Signed-off-by: Kangjie Lu &lt;kjlu@umn.edu&gt;
    [lorenzo.pieralisi@arm.com: commit log and code update]
    Signed-off-by: Lorenzo Pieralisi &lt;lorenzo.pieralisi@arm.com&gt;

diff --git a/drivers/pci/endpoint/functions/pci-epf-test.c b/drivers/pci/endpoint/functions/pci-epf-test.c
index d0b91da49bf4..ed5cd28b9572 100644
--- a/drivers/pci/endpoint/functions/pci-epf-test.c
+++ b/drivers/pci/endpoint/functions/pci-epf-test.c
@@ -591,6 +591,11 @@ static int __init pci_epf_test_init(void)
 
 	kpcitest_workqueue = alloc_workqueue("kpcitest",
 					     WQ_MEM_RECLAIM | WQ_HIGHPRI, 0);
+	if (!kpcitest_workqueue) {
+		pr_err("Failed to allocate the kpcitest work queue\n");
+		return -ENOMEM;
+	}
+
 	ret = pci_epf_register_driver(&amp;test_driver);
 	if (ret) {
 		pr_err("Failed to register pci epf test driver --&gt; %d\n", ret);</pre><hr><pre>commit e183d4e414b64711baf7a04e214b61969ca08dfa
Author: Kangjie Lu &lt;kjlu@umn.edu&gt;
Date:   Thu Apr 11 11:17:31 2019 +0200

    net/smc: fix a NULL pointer dereference
    
    In case alloc_ordered_workqueue fails, the fix returns NULL
    to avoid NULL pointer dereference.
    
    Signed-off-by: Kangjie Lu &lt;kjlu@umn.edu&gt;
    Signed-off-by: Ursula Braun &lt;ubraun@linux.ibm.com&gt;
    Signed-off-by: David S. Miller &lt;davem@davemloft.net&gt;

diff --git a/net/smc/smc_ism.c b/net/smc/smc_ism.c
index 2fff79db1a59..e89e918b88e0 100644
--- a/net/smc/smc_ism.c
+++ b/net/smc/smc_ism.c
@@ -289,6 +289,11 @@ struct smcd_dev *smcd_alloc_dev(struct device *parent, const char *name,
 	INIT_LIST_HEAD(&amp;smcd-&gt;vlan);
 	smcd-&gt;event_wq = alloc_ordered_workqueue("ism_evt_wq-%s)",
 						 WQ_MEM_RECLAIM, name);
+	if (!smcd-&gt;event_wq) {
+		kfree(smcd-&gt;conn);
+		kfree(smcd);
+		return NULL;
+	}
 	return smcd;
 }
 EXPORT_SYMBOL_GPL(smcd_alloc_dev);</pre><hr><pre>commit d1a0846006e4325cc951ca0b05c02ed1d0865006
Author: Kangjie Lu &lt;kjlu@umn.edu&gt;
Date:   Fri Mar 15 16:00:25 2019 -0500

    security: inode: fix a missing check for securityfs_create_file
    
    securityfs_create_file  may fail. The fix checks its status and
    returns the error code upstream if it fails.
    
    Signed-off-by: Kangjie Lu &lt;kjlu@umn.edu&gt;
    Signed-off-by: James Morris &lt;james.morris@microsoft.com&gt;

diff --git a/security/inode.c b/security/inode.c
index b7772a9b315e..667f8b15027d 100644
--- a/security/inode.c
+++ b/security/inode.c
@@ -339,6 +339,11 @@ static int __init securityfs_init(void)
 #ifdef CONFIG_SECURITY
 	lsm_dentry = securityfs_create_file("lsm", 0444, NULL, NULL,
 						&amp;lsm_ops);
+	if (IS_ERR(lsm_dentry)) {
+		unregister_filesystem(&amp;fs_type);
+		sysfs_remove_mount_point(kernel_kobj, "security");
+		return PTR_ERR(lsm_dentry);
+	}
 #endif
 	return 0;
 }</pre><hr><pre>commit 1adc90c7395742827d754a5f02f446818a77c379
Author: Aditya Pakki &lt;pakki001@umn.edu&gt;
Date:   Tue Mar 12 10:19:10 2019 -0500

    pinctrl: axp209: Fix NULL pointer dereference after allocation
    
    axp20x_build_funcs_groups allocates groups via devm_kcalloc and tries to
    dereference without checking for NULL. This patch avoids such a
    scenario.
    
    Signed-off-by: Aditya Pakki &lt;pakki001@umn.edu&gt;
    Signed-off-by: Linus Walleij &lt;linus.walleij@linaro.org&gt;

diff --git a/drivers/pinctrl/pinctrl-axp209.c b/drivers/pinctrl/pinctrl-axp209.c
index afd0b533c40a..4fcf7262bed9 100644
--- a/drivers/pinctrl/pinctrl-axp209.c
+++ b/drivers/pinctrl/pinctrl-axp209.c
@@ -366,6 +366,8 @@ static int axp20x_build_funcs_groups(struct platform_device *pdev)
 		pctl-&gt;funcs[i].groups = devm_kcalloc(&amp;pdev-&gt;dev,
 						     npins, sizeof(char *),
 						     GFP_KERNEL);
+		if (!pctl-&gt;funcs[i].groups)
+			return -ENOMEM;
 		for (pin = 0; pin &lt; npins; pin++)
 			pctl-&gt;funcs[i].groups[pin] = pctl-&gt;desc-&gt;pins[pin].name;
 	}</pre><hr><pre>commit 6f0ce4dfc5a35bcb21f26d5347f4797fdde52810
Author: Aditya Pakki &lt;pakki001@umn.edu&gt;
Date:   Mon Mar 18 18:24:34 2019 -0500

    mtd: rawnand: vf610: Avoid a potential NULL pointer dereference
    
    of_match_device can return NULL if there is no matching device. Avoid
    a potential NULL pointer dereference by checking for the return value
    and passing the error upstream.
    
    Signed-off-by: Aditya Pakki &lt;pakki001@umn.edu&gt;
    Signed-off-by: Miquel Raynal &lt;miquel.raynal@bootlin.com&gt;

diff --git a/drivers/mtd/nand/raw/vf610_nfc.c b/drivers/mtd/nand/raw/vf610_nfc.c
index a662ca1970e5..6d43ddb3332f 100644
--- a/drivers/mtd/nand/raw/vf610_nfc.c
+++ b/drivers/mtd/nand/raw/vf610_nfc.c
@@ -850,6 +850,9 @@ static int vf610_nfc_probe(struct platform_device *pdev)
 	}
 
 	of_id = of_match_device(vf610_nfc_dt_ids, &amp;pdev-&gt;dev);
+	if (!of_id)
+		return -ENODEV;
+
 	nfc-&gt;variant = (enum vf610_nfc_variant)of_id-&gt;data;
 
 	for_each_available_child_of_node(nfc-&gt;dev-&gt;of_node, child) {</pre><hr><pre>commit 75cf4f5aa903604e1bd7bec2c0988d643c6fb946
Author: Kangjie Lu &lt;kjlu@umn.edu&gt;
Date:   Thu Mar 14 01:02:47 2019 -0500

    power: charger-manager: fix a potential NULL pointer dereference
    
    In case create_freezable_workqueue fails, the fix return -ENOMEM
    to avoid a potential NULL pointer dereference.
    
    Signed-off-by: Kangjie Lu &lt;kjlu@umn.edu&gt;
    Signed-off-by: Sebastian Reichel &lt;sebastian.reichel@collabora.com&gt;

diff --git a/drivers/power/supply/charger-manager.c b/drivers/power/supply/charger-manager.c
index 2e8db5e6de0b..a6900aa0d2ed 100644
--- a/drivers/power/supply/charger-manager.c
+++ b/drivers/power/supply/charger-manager.c
@@ -1987,6 +1987,9 @@ static struct platform_driver charger_manager_driver = {
 static int __init charger_manager_init(void)
 {
 	cm_wq = create_freezable_workqueue("charger_manager");
+	if (unlikely(!cm_wq))
+		return -ENOMEM;
+
 	INIT_DELAYED_WORK(&amp;cm_monitor_work, cm_monitor_poller);
 
 	return platform_driver_register(&amp;charger_manager_driver);</pre><hr><pre>commit 536cc27deade8f1ec3c1beefa60d5fbe0f6fcb28
Author: Kangjie Lu &lt;kjlu@umn.edu&gt;
Date:   Sat Mar 16 17:08:33 2019 -0500

    iio: hmc5843: fix potential NULL pointer dereferences
    
    devm_regmap_init_i2c may fail and return NULL. The fix returns
    the error when it fails.
    
    Signed-off-by: Kangjie Lu &lt;kjlu@umn.edu&gt;
    Signed-off-by: Jonathan Cameron &lt;Jonathan.Cameron@huawei.com&gt;

diff --git a/drivers/iio/magnetometer/hmc5843_i2c.c b/drivers/iio/magnetometer/hmc5843_i2c.c
index 3de7f4426ac4..86abba5827a2 100644
--- a/drivers/iio/magnetometer/hmc5843_i2c.c
+++ b/drivers/iio/magnetometer/hmc5843_i2c.c
@@ -58,8 +58,13 @@ static const struct regmap_config hmc5843_i2c_regmap_config = {
 static int hmc5843_i2c_probe(struct i2c_client *cli,
 			     const struct i2c_device_id *id)
 {
+	struct regmap *regmap = devm_regmap_init_i2c(cli,
+			&amp;hmc5843_i2c_regmap_config);
+	if (IS_ERR(regmap))
+		return PTR_ERR(regmap);
+
 	return hmc5843_common_probe(&amp;cli-&gt;dev,
-			devm_regmap_init_i2c(cli, &amp;hmc5843_i2c_regmap_config),
+			regmap,
 			id-&gt;driver_data, id-&gt;name);
 }
 
diff --git a/drivers/iio/magnetometer/hmc5843_spi.c b/drivers/iio/magnetometer/hmc5843_spi.c
index 535f03a70d63..79b2b707f90e 100644
--- a/drivers/iio/magnetometer/hmc5843_spi.c
+++ b/drivers/iio/magnetometer/hmc5843_spi.c
@@ -58,6 +58,7 @@ static const struct regmap_config hmc5843_spi_regmap_config = {
 static int hmc5843_spi_probe(struct spi_device *spi)
 {
 	int ret;
+	struct regmap *regmap;
 	const struct spi_device_id *id = spi_get_device_id(spi);
 
 	spi-&gt;mode = SPI_MODE_3;
@@ -67,8 +68,12 @@ static int hmc5843_spi_probe(struct spi_device *spi)
 	if (ret)
 		return ret;
 
+	regmap = devm_regmap_init_spi(spi, &amp;hmc5843_spi_regmap_config);
+	if (IS_ERR(regmap))
+		return PTR_ERR(regmap);
+
 	return hmc5843_common_probe(&amp;spi-&gt;dev,
-			devm_regmap_init_spi(spi, &amp;hmc5843_spi_regmap_config),
+			regmap,
 			id-&gt;driver_data, id-&gt;name);
 }
 </pre>
    <div class="pagination">
        <a href='7_12.html'>&lt;&lt;Prev</a><a href='7.html'>1</a><a href='7_2.html'>2</a><a href='7_3.html'>3</a><a href='7_4.html'>4</a><a href='7_5.html'>5</a><a href='7_6.html'>6</a><a href='7_7.html'>7</a><a href='7_8.html'>8</a><a href='7_9.html'>9</a><a href='7_10.html'>10</a><a href='7_11.html'>11</a><a href='7_12.html'>12</a><span>[13]</span><a href='7_14.html'>14</a><a href='7_15.html'>15</a><a href='7_16.html'>16</a><a href='7_17.html'>17</a><a href='7_18.html'>18</a><a href='7_19.html'>19</a><a href='7_20.html'>20</a><a href='7_21.html'>21</a><a href='7_22.html'>22</a><a href='7_23.html'>23</a><a href='7_24.html'>24</a><a href='7_25.html'>25</a><a href='7_26.html'>26</a><a href='7_27.html'>27</a><a href='7_28.html'>28</a><a href='7_29.html'>29</a><a href='7_30.html'>30</a><a href='7_14.html'>Next&gt;&gt;</a>
    <div>
</body>
