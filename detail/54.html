<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patches contributed by Universidad Politécnica de Cataluna</title>
    <style>
    .pagination {
        border-top: 1px solid #ddd;
        border-bottom: 1px solid #ddd;
        overflow-wrap: break-word;
    }
    .pagination a, .pagination span {
        margin: 0 4px;
    }

    </style>
</head>
<body>
    <h1>Patches contributed by Universidad Politécnica de Cataluna</h1>
    <div class="pagination">
        <span>[1]</span>
    </div>
    <hr>
    <pre>commit 3734dfc68b64d8ca202c799280daf28c2424659d
Author: Julio M. Merino Vidal &lt;jmerino@ac.upc.edu&gt;
Date:   Wed Apr 30 15:21:17 2008 +1000

    [POWERPC] spufs: trace spu_acquire_saved events
    
    The sputrace module contained a trace entry for spu_acquire_saved, but
    this marker was not placed anywhere. Fix this by adding a marker to the
    routine.
    
    Signed-off-by: Julio M. Merino Vidal &lt;jmerino@ac.upc.edu&gt;
    Signed-off-by: Jeremy Kerr &lt;jk@ozlabs.org&gt;

diff --git a/arch/powerpc/platforms/cell/spufs/context.c b/arch/powerpc/platforms/cell/spufs/context.c
index 5c5010078042..177735f79317 100644
--- a/arch/powerpc/platforms/cell/spufs/context.c
+++ b/arch/powerpc/platforms/cell/spufs/context.c
@@ -152,6 +152,8 @@ int spu_acquire_saved(struct spu_context *ctx)
 {
 	int ret;
 
+	spu_context_nospu_trace(spu_acquire_saved__enter, ctx);
+
 	ret = spu_acquire(ctx);
 	if (ret)
 		return ret;</pre><hr><pre>commit 8a476d49555cb7e8d4222782f695048b46692731
Author: Julio M. Merino Vidal &lt;jmerino@ac.upc.edu&gt;
Date:   Wed Apr 30 15:16:14 2008 +1000

    [POWERPC] spufs: fix marker name for find_victim
    
    Fix a typo in the marker for the find_victim function, which prevented
    it from being traced. It previously read find_vitim.
    
    Signed-off-by: Julio M. Merino Vidal &lt;jmerino@ac.upc.edu&gt;
    Signed-off-by: Jeremy Kerr &lt;jk@ozlabs.org&gt;

diff --git a/arch/powerpc/platforms/cell/spufs/sched.c b/arch/powerpc/platforms/cell/spufs/sched.c
index 31e9d85761c2..62280c292aac 100644
--- a/arch/powerpc/platforms/cell/spufs/sched.c
+++ b/arch/powerpc/platforms/cell/spufs/sched.c
@@ -593,7 +593,7 @@ static struct spu *find_victim(struct spu_context *ctx)
 	struct spu *spu;
 	int node, n;
 
-	spu_context_nospu_trace(spu_find_vitim__enter, ctx);
+	spu_context_nospu_trace(spu_find_victim__enter, ctx);
 
 	/*
 	 * Look for a possible preemption candidate on the local node first.</pre><hr><pre>commit 534578816f028b0dc675fdcc3314016d98588327
Author: Julio M. Merino Vidal &lt;jmerino@ac.upc.edu&gt;
Date:   Wed Apr 30 15:12:30 2008 +1000

    [POWERPC] spufs: add marker for destroy_spu_context
    
    The sputrace module contained a reference to a marker for
    destroy_spu_context, but this marker did not appear in the code. Fix
    this by adding a marker in the function.
    
    Signed-off-by: Julio M. Merino Vidal &lt;jmerino@ac.upc.edu&gt;
    Signed-off-by: Jeremy Kerr &lt;jk@ozlabs.org&gt;

diff --git a/arch/powerpc/platforms/cell/spufs/context.c b/arch/powerpc/platforms/cell/spufs/context.c
index 91f2d4d9aefd..5c5010078042 100644
--- a/arch/powerpc/platforms/cell/spufs/context.c
+++ b/arch/powerpc/platforms/cell/spufs/context.c
@@ -78,6 +78,7 @@ void destroy_spu_context(struct kref *kref)
 {
 	struct spu_context *ctx;
 	ctx = container_of(kref, struct spu_context, kref);
+	spu_context_nospu_trace(destroy_spu_context__enter, ctx);
 	mutex_lock(&amp;ctx-&gt;state_mutex);
 	spu_deactivate(ctx);
 	mutex_unlock(&amp;ctx-&gt;state_mutex);</pre><hr><pre>commit d6508aaf27ccef0d7e986aaa220ad4d098bca260
Author: Julio M. Merino Vidal &lt;jmerino@ac.upc.edu&gt;
Date:   Wed Apr 30 15:06:39 2008 +1000

    [POWERPC] spufs: add sputrace marker parameter names
    
    The markers facility defines the marker parameters to be of the form
    'name %format'. Add parameter names to sputrace, to specify the context
    and %spu paramerters,  instead of just specifying the '%format' part.
    
    Signed-off-by: Julio M. Merino Vidal &lt;jmerino@ac.upc.edu&gt;
    Signed-off-by: Jeremy Kerr &lt;jk@ozlabs.org&gt;

diff --git a/arch/powerpc/platforms/cell/spufs/spufs.h b/arch/powerpc/platforms/cell/spufs/spufs.h
index dd63b16bb072..7312745b7540 100644
--- a/arch/powerpc/platforms/cell/spufs/spufs.h
+++ b/arch/powerpc/platforms/cell/spufs/spufs.h
@@ -359,8 +359,8 @@ extern void spuctx_switch_state(struct spu_context *ctx,
 		enum spu_utilization_state new_state);
 
 #define spu_context_trace(name, ctx, spu) \
-	trace_mark(name, "%p %p", ctx, spu);
+	trace_mark(name, "ctx %p spu %p", ctx, spu);
 #define spu_context_nospu_trace(name, ctx) \
-	trace_mark(name, "%p", ctx);
+	trace_mark(name, "ctx %p", ctx);
 
 #endif
diff --git a/arch/powerpc/platforms/cell/spufs/sputrace.c b/arch/powerpc/platforms/cell/spufs/sputrace.c
index 79aa773f3c99..b9c79eda3359 100644
--- a/arch/powerpc/platforms/cell/spufs/sputrace.c
+++ b/arch/powerpc/platforms/cell/spufs/sputrace.c
@@ -171,24 +171,24 @@ static void spu_context_nospu_event(void *probe_private, void *call_data,
 }
 
 struct spu_probe spu_probes[] = {
-	{ "spu_bind_context__enter", "%p %p", spu_context_event },
-	{ "spu_unbind_context__enter", "%p %p", spu_context_event },
-	{ "spu_get_idle__enter", "%p", spu_context_nospu_event },
-	{ "spu_get_idle__found", "%p %p", spu_context_event },
-	{ "spu_get_idle__not_found", "%p", spu_context_nospu_event },
-	{ "spu_find_victim__enter", "%p", spu_context_nospu_event },
-	{ "spusched_tick__preempt", "%p %p", spu_context_event },
-	{ "spusched_tick__newslice", "%p", spu_context_nospu_event },
-	{ "spu_yield__enter", "%p", spu_context_nospu_event },
-	{ "spu_deactivate__enter", "%p", spu_context_nospu_event },
-	{ "__spu_deactivate__unload", "%p %p", spu_context_event },
-	{ "spufs_ps_nopfn__enter", "%p", spu_context_nospu_event },
-	{ "spufs_ps_nopfn__sleep", "%p", spu_context_nospu_event },
-	{ "spufs_ps_nopfn__wake", "%p %p", spu_context_event },
-	{ "spufs_ps_nopfn__insert", "%p %p", spu_context_event },
-	{ "spu_acquire_saved__enter", "%p", spu_context_nospu_event },
-	{ "destroy_spu_context__enter", "%p", spu_context_nospu_event },
-	{ "spufs_stop_callback__enter", "%p %p", spu_context_event },
+	{ "spu_bind_context__enter", "ctx %p spu %p", spu_context_event },
+	{ "spu_unbind_context__enter", "ctx %p spu %p", spu_context_event },
+	{ "spu_get_idle__enter", "ctx %p", spu_context_nospu_event },
+	{ "spu_get_idle__found", "ctx %p spu %p", spu_context_event },
+	{ "spu_get_idle__not_found", "ctx %p", spu_context_nospu_event },
+	{ "spu_find_victim__enter", "ctx %p", spu_context_nospu_event },
+	{ "spusched_tick__preempt", "ctx %p spu %p", spu_context_event },
+	{ "spusched_tick__newslice", "ctx %p", spu_context_nospu_event },
+	{ "spu_yield__enter", "ctx %p", spu_context_nospu_event },
+	{ "spu_deactivate__enter", "ctx %p", spu_context_nospu_event },
+	{ "__spu_deactivate__unload", "ctx %p spu %p", spu_context_event },
+	{ "spufs_ps_nopfn__enter", "ctx %p", spu_context_nospu_event },
+	{ "spufs_ps_nopfn__sleep", "ctx %p", spu_context_nospu_event },
+	{ "spufs_ps_nopfn__wake", "ctx %p spu %p", spu_context_event },
+	{ "spufs_ps_nopfn__insert", "ctx %p spu %p", spu_context_event },
+	{ "spu_acquire_saved__enter", "ctx %p", spu_context_nospu_event },
+	{ "destroy_spu_context__enter", "ctx %p", spu_context_nospu_event },
+	{ "spufs_stop_callback__enter", "ctx %p spu %p", spu_context_event },
 };
 
 static int __init sputrace_init(void)</pre><hr><pre>commit 9b1d21f858e8bad750ab19cac23dcbf79d099be3
Author: Julio M. Merino Vidal &lt;jmerino@ac.upc.edu&gt;
Date:   Thu Dec 20 16:39:59 2007 +0900

    [POWERPC] spufs: fix typos in sched.c comments
    
    Fix a few typos in the spufs scheduler comments
    
    Signed-off-by: Julio M. Merino Vidal &lt;jmerino@ac.upc.edu&gt;
    Signed-off-by: Jeremy Kerr &lt;jk@ozlabs.org&gt;
    Signed-off-by: Paul Mackerras &lt;paulus@samba.org&gt;

diff --git a/arch/powerpc/platforms/cell/spufs/sched.c b/arch/powerpc/platforms/cell/spufs/sched.c
index 4d257b3f9336..0117eb8f6a91 100644
--- a/arch/powerpc/platforms/cell/spufs/sched.c
+++ b/arch/powerpc/platforms/cell/spufs/sched.c
@@ -105,15 +105,15 @@ void spu_set_timeslice(struct spu_context *ctx)
 void __spu_update_sched_info(struct spu_context *ctx)
 {
 	/*
-	 * 32-Bit assignment are atomic on powerpc, and we don't care about
-	 * memory ordering here because retriving the controlling thread is
-	 * per defintion racy.
+	 * 32-Bit assignments are atomic on powerpc, and we don't care about
+	 * memory ordering here because retrieving the controlling thread is
+	 * per definition racy.
 	 */
 	ctx-&gt;tid = current-&gt;pid;
 
 	/*
 	 * We do our own priority calculations, so we normally want
-	 * -&gt;static_prio to start with. Unfortunately thies field
+	 * -&gt;static_prio to start with. Unfortunately this field
 	 * contains junk for threads with a realtime scheduling
 	 * policy so we have to look at -&gt;prio in this case.
 	 */
@@ -127,7 +127,7 @@ void __spu_update_sched_info(struct spu_context *ctx)
 	 * A lot of places that don't hold list_mutex poke into
 	 * cpus_allowed, including grab_runnable_context which
 	 * already holds the runq_lock.  So abuse runq_lock
-	 * to protect this field aswell.
+	 * to protect this field as well.
 	 */
 	spin_lock(&amp;spu_prio-&gt;runq_lock);
 	ctx-&gt;cpus_allowed = current-&gt;cpus_allowed;
@@ -182,7 +182,7 @@ static void notify_spus_active(void)
 	 * Wake up the active spu_contexts.
 	 *
 	 * When the awakened processes see their "notify_active" flag is set,
-	 * they will call spu_switch_notify();
+	 * they will call spu_switch_notify().
 	 */
 	for_each_online_node(node) {
 		struct spu *spu;
@@ -579,7 +579,7 @@ static struct spu *find_victim(struct spu_context *ctx)
 	/*
 	 * Look for a possible preemption candidate on the local node first.
 	 * If there is no candidate look at the other nodes.  This isn't
-	 * exactly fair, but so far the whole spu schedule tries to keep
+	 * exactly fair, but so far the whole spu scheduler tries to keep
 	 * a strong node affinity.  We might want to fine-tune this in
 	 * the future.
 	 */
@@ -905,7 +905,7 @@ static int show_spu_loadavg(struct seq_file *s, void *private)
 
 	/*
 	 * Note that last_pid doesn't really make much sense for the
-	 * SPU loadavg (it even seems very odd on the CPU side..),
+	 * SPU loadavg (it even seems very odd on the CPU side...),
 	 * but we include it here to have a 100% compatible interface.
 	 */
 	seq_printf(s, "%d.%02d %d.%02d %d.%02d %ld/%d %d\n",</pre><hr><pre>commit 568e0c1119d7ff33fbcddc0dec9e2c799a53352d
Author: Julio M. Merino Vidal &lt;jmerino@ac.upc.edu&gt;
Date:   Sat Oct 20 00:36:33 2007 +0200

    powerpc: Remove obsolete prototype
    
    The include/asm-powerpc/paca.h file has a prototype for a function that
    does not exist any more; its name is setup_boot_paca.  This function was
    removed in commit 4ba99b97dadd35b9ce1438b2bc7c992a4a14a8b1, so its
    prototype should have been removed at that time too.
    
    Signed-off-by: Julio M. Merino Vidal &lt;jmerino@ac.upc.edu&gt;
    Signed-off-by: Adrian Bunk &lt;bunk@kernel.org&gt;

diff --git a/include/asm-powerpc/paca.h b/include/asm-powerpc/paca.h
index 98c6bd5756b7..f6dfce025adf 100644
--- a/include/asm-powerpc/paca.h
+++ b/include/asm-powerpc/paca.h
@@ -121,7 +121,5 @@ struct paca_struct {
 
 extern struct paca_struct paca[];
 
-void setup_boot_paca(void);
-
 #endif /* __KERNEL__ */
 #endif /* _ASM_POWERPC_PACA_H */</pre>
    <div class="pagination">
        <span>[1]</span>
    <div>
</body>
