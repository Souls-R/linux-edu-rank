<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patches contributed by University of Virginia, Charlottesville</title>
    <style>
    .pagination {
        border-top: 1px solid #ddd;
        border-bottom: 1px solid #ddd;
        overflow-wrap: break-word;
    }
    .pagination a, .pagination span {
        margin: 0 4px;
    }

    </style>
</head>
<body>
    <h1>Patches contributed by University of Virginia, Charlottesville</h1>
    <div class="pagination">
        <a href='3_44.html'>&lt;&lt;Prev</a><a href='3.html'>1</a><a href='3_2.html'>2</a><a href='3_3.html'>3</a><a href='3_4.html'>4</a><a href='3_5.html'>5</a><a href='3_6.html'>6</a><a href='3_7.html'>7</a><a href='3_8.html'>8</a><a href='3_9.html'>9</a><a href='3_10.html'>10</a><a href='3_11.html'>11</a><a href='3_12.html'>12</a><a href='3_13.html'>13</a><a href='3_14.html'>14</a><a href='3_15.html'>15</a><a href='3_16.html'>16</a><a href='3_17.html'>17</a><a href='3_18.html'>18</a><a href='3_19.html'>19</a><a href='3_20.html'>20</a><a href='3_21.html'>21</a><a href='3_22.html'>22</a><a href='3_23.html'>23</a><a href='3_24.html'>24</a><a href='3_25.html'>25</a><a href='3_26.html'>26</a><a href='3_27.html'>27</a><a href='3_28.html'>28</a><a href='3_29.html'>29</a><a href='3_30.html'>30</a><a href='3_31.html'>31</a><a href='3_32.html'>32</a><a href='3_33.html'>33</a><a href='3_34.html'>34</a><a href='3_35.html'>35</a><a href='3_36.html'>36</a><a href='3_37.html'>37</a><a href='3_38.html'>38</a><a href='3_39.html'>39</a><a href='3_40.html'>40</a><a href='3_41.html'>41</a><a href='3_42.html'>42</a><a href='3_43.html'>43</a><a href='3_44.html'>44</a><span>[45]</span><a href='3_46.html'>46</a><a href='3_47.html'>47</a><a href='3_48.html'>48</a><a href='3_49.html'>49</a><a href='3_50.html'>50</a><a href='3_51.html'>51</a><a href='3_52.html'>52</a><a href='3_53.html'>53</a><a href='3_54.html'>54</a><a href='3_55.html'>55</a><a href='3_56.html'>56</a><a href='3_57.html'>57</a><a href='3_58.html'>58</a><a href='3_59.html'>59</a><a href='3_60.html'>60</a><a href='3_61.html'>61</a><a href='3_62.html'>62</a><a href='3_63.html'>63</a><a href='3_64.html'>64</a><a href='3_65.html'>65</a><a href='3_66.html'>66</a><a href='3_67.html'>67</a><a href='3_68.html'>68</a><a href='3_69.html'>69</a><a href='3_70.html'>70</a><a href='3_71.html'>71</a><a href='3_72.html'>72</a><a href='3_73.html'>73</a><a href='3_74.html'>74</a><a href='3_75.html'>75</a><a href='3_76.html'>76</a><a href='3_77.html'>77</a><a href='3_78.html'>78</a><a href='3_79.html'>79</a><a href='3_80.html'>80</a><a href='3_81.html'>81</a><a href='3_82.html'>82</a><a href='3_83.html'>83</a><a href='3_46.html'>Next&gt;&gt;</a>
    </div>
    <hr>
    <pre>commit 7a09876d2a68aab6c7a7d9df60eb0eb13467af11
Author: Bill Pemberton &lt;wfp5p@virginia.edu&gt;
Date:   Wed May 5 15:27:55 2010 -0400

    staging: hv: replace ASSERT() with WARN_ON() in NetVsc.c
    
    Signed-off-by: Bill Pemberton &lt;wfp5p@virginia.edu&gt;
    Cc: Hank Janssen &lt;hjanssen@microsoft.com&gt;
    Cc: Haiyang Zhang &lt;haiyangz@microsoft.com&gt;
    Signed-off-by: Greg Kroah-Hartman &lt;gregkh@suse.de&gt;

diff --git a/drivers/staging/hv/NetVsc.c b/drivers/staging/hv/NetVsc.c
index 9863ca252bd9..ddde39136b6e 100644
--- a/drivers/staging/hv/NetVsc.c
+++ b/drivers/staging/hv/NetVsc.c
@@ -92,7 +92,7 @@ static struct netvsc_device *AllocNetDevice(struct hv_device *Device)
 
 static void FreeNetDevice(struct netvsc_device *Device)
 {
-	ASSERT(atomic_read(&amp;Device-&gt;RefCount) == 0);
+	WARN_ON(atomic_read(&amp;Device-&gt;RefCount) == 0);
 	Device-&gt;Device-&gt;Extension = NULL;
 	kfree(Device);
 }</pre><hr><pre>commit 972b9529ccfa604bd473c43589f5120066161edd
Author: Bill Pemberton &lt;wfp5p@virginia.edu&gt;
Date:   Wed May 5 15:27:54 2010 -0400

    staging: hv: remove ASSERT()s
    
    These ASSERT()s serve no purpose other than for debugging.
    
    Signed-off-by: Bill Pemberton &lt;wfp5p@virginia.edu&gt;
    Cc: Hank Janssen &lt;hjanssen@microsoft.com&gt;
    Cc: Haiyang Zhang &lt;haiyangz@microsoft.com&gt;
    Signed-off-by: Greg Kroah-Hartman &lt;gregkh@suse.de&gt;

diff --git a/drivers/staging/hv/BlkVsc.c b/drivers/staging/hv/BlkVsc.c
index a48ee3a12646..b2f600551f10 100644
--- a/drivers/staging/hv/BlkVsc.c
+++ b/drivers/staging/hv/BlkVsc.c
@@ -78,7 +78,7 @@ int BlkVscInitialize(struct hv_driver *Driver)
 	storDriver = (struct storvsc_driver_object *)Driver;
 
 	/* Make sure we are at least 2 pages since 1 page is used for control */
-	ASSERT(storDriver-&gt;RingBufferSize &gt;= (PAGE_SIZE &lt;&lt; 1));
+	/* ASSERT(storDriver-&gt;RingBufferSize &gt;= (PAGE_SIZE &lt;&lt; 1)); */
 
 	Driver-&gt;name = gBlkDriverName;
 	memcpy(&amp;Driver-&gt;deviceType, &amp;gBlkVscDeviceType, sizeof(struct hv_guid));
diff --git a/drivers/staging/hv/Connection.c b/drivers/staging/hv/Connection.c
index e590eb4b6e76..3a01d3ca4ad0 100644
--- a/drivers/staging/hv/Connection.c
+++ b/drivers/staging/hv/Connection.c
@@ -254,7 +254,7 @@ static void VmbusProcessChannelEvent(void *context)
 	struct vmbus_channel *channel;
 	u32 relId = (u32)(unsigned long)context;
 
-	ASSERT(relId &gt; 0);
+	/* ASSERT(relId &gt; 0); */
 
 	/*
 	 * Find the channel based on this relid and invokes the
diff --git a/drivers/staging/hv/NetVsc.c b/drivers/staging/hv/NetVsc.c
index d3154e711776..9863ca252bd9 100644
--- a/drivers/staging/hv/NetVsc.c
+++ b/drivers/staging/hv/NetVsc.c
@@ -131,7 +131,7 @@ static void PutNetDevice(struct hv_device *Device)
 	struct netvsc_device *netDevice;
 
 	netDevice = Device-&gt;Extension;
-	ASSERT(netDevice);
+	/* ASSERT(netDevice); */
 
 	atomic_dec(&amp;netDevice-&gt;RefCount);
 }
@@ -184,14 +184,15 @@ int NetVscInitialize(struct hv_driver *drv)
 		   sizeof(struct vmtransfer_page_packet_header));
 
 	/* Make sure we are at least 2 pages since 1 page is used for control */
-	ASSERT(driver-&gt;RingBufferSize &gt;= (PAGE_SIZE &lt;&lt; 1));
+	/* ASSERT(driver-&gt;RingBufferSize &gt;= (PAGE_SIZE &lt;&lt; 1)); */
 
 	drv-&gt;name = gDriverName;
 	memcpy(&amp;drv-&gt;deviceType, &amp;gNetVscDeviceType, sizeof(struct hv_guid));
 
 	/* Make sure it is set by the caller */
-	ASSERT(driver-&gt;OnReceiveCallback);
-	ASSERT(driver-&gt;OnLinkStatusChanged);
+	/* FIXME: These probably should still be tested in some way */
+	/* ASSERT(driver-&gt;OnReceiveCallback); */
+	/* ASSERT(driver-&gt;OnLinkStatusChanged); */
 
 	/* Setup the dispatch table */
 	driver-&gt;Base.OnDeviceAdd	= NetVscOnDeviceAdd;
@@ -222,9 +223,9 @@ static int NetVscInitializeReceiveBufferWithNetVsp(struct hv_device *Device)
 		DPRINT_EXIT(NETVSC);
 		return -1;
 	}
-	ASSERT(netDevice-&gt;ReceiveBufferSize &gt; 0);
+	/* ASSERT(netDevice-&gt;ReceiveBufferSize &gt; 0); */
 	/* page-size grandularity */
-	ASSERT((netDevice-&gt;ReceiveBufferSize &amp; (PAGE_SIZE - 1)) == 0);
+	/* ASSERT((netDevice-&gt;ReceiveBufferSize &amp; (PAGE_SIZE - 1)) == 0); */
 
 	netDevice-&gt;ReceiveBuffer =
 		osd_PageAlloc(netDevice-&gt;ReceiveBufferSize &gt;&gt; PAGE_SHIFT);
@@ -236,8 +237,8 @@ static int NetVscInitializeReceiveBufferWithNetVsp(struct hv_device *Device)
 		goto Cleanup;
 	}
 	/* page-aligned buffer */
-	ASSERT(((unsigned long)netDevice-&gt;ReceiveBuffer &amp; (PAGE_SIZE - 1)) ==
-		0);
+	/* ASSERT(((unsigned long)netDevice-&gt;ReceiveBuffer &amp; (PAGE_SIZE - 1)) == */
+	/* 	0); */
 
 	DPRINT_INFO(NETVSC, "Establishing receive buffer's GPADL...");
 
@@ -294,8 +295,8 @@ static int NetVscInitializeReceiveBufferWithNetVsp(struct hv_device *Device)
 	}
 
 	/* Parse the response */
-	ASSERT(netDevice-&gt;ReceiveSectionCount == 0);
-	ASSERT(netDevice-&gt;ReceiveSections == NULL);
+	/* ASSERT(netDevice-&gt;ReceiveSectionCount == 0); */
+	/* ASSERT(netDevice-&gt;ReceiveSections == NULL); */
 
 	netDevice-&gt;ReceiveSectionCount = initPacket-&gt;Messages.Version1Messages.SendReceiveBufferComplete.NumSections;
 
@@ -355,7 +356,7 @@ static int NetVscInitializeSendBufferWithNetVsp(struct hv_device *Device)
 	}
 	ASSERT(netDevice-&gt;SendBufferSize &gt; 0);
 	/* page-size grandularity */
-	ASSERT((netDevice-&gt;SendBufferSize &amp; (PAGE_SIZE - 1)) == 0);
+	/* ASSERT((netDevice-&gt;SendBufferSize &amp; (PAGE_SIZE - 1)) == 0); */
 
 	netDevice-&gt;SendBuffer =
 		osd_PageAlloc(netDevice-&gt;SendBufferSize &gt;&gt; PAGE_SHIFT);
@@ -366,7 +367,7 @@ static int NetVscInitializeSendBufferWithNetVsp(struct hv_device *Device)
 		goto Cleanup;
 	}
 	/* page-aligned buffer */
-	ASSERT(((unsigned long)netDevice-&gt;SendBuffer &amp; (PAGE_SIZE - 1)) == 0);
+	/* ASSERT(((unsigned long)netDevice-&gt;SendBuffer &amp; (PAGE_SIZE - 1)) == 0); */
 
 	DPRINT_INFO(NETVSC, "Establishing send buffer's GPADL...");
 
@@ -912,7 +913,7 @@ static void NetVscOnSendCompletion(struct hv_device *Device,
 		   NvspMessage1TypeSendRNDISPacketComplete) {
 		/* Get the send context */
 		nvscPacket = (struct hv_netvsc_packet *)(unsigned long)Packet-&gt;TransactionId;
-		ASSERT(nvscPacket);
+		/* ASSERT(nvscPacket); */
 
 		/* Notify the layer above us */
 		nvscPacket-&gt;Completion.Send.OnSendCompletion(nvscPacket-&gt;Completion.Send.SendCompletionContext);
@@ -1096,8 +1097,8 @@ static void NetVscOnReceive(struct hv_device *Device,
 
 	/* This is how much we can satisfy */
 	xferpagePacket-&gt;Count = count - 1;
-	ASSERT(xferpagePacket-&gt;Count &gt; 0 &amp;&amp; xferpagePacket-&gt;Count &lt;=
-		vmxferpagePacket-&gt;RangeCount);
+	/* ASSERT(xferpagePacket-&gt;Count &gt; 0 &amp;&amp; xferpagePacket-&gt;Count &lt;= */
+	/* 	vmxferpagePacket-&gt;RangeCount); */
 
 	if (xferpagePacket-&gt;Count != vmxferpagePacket-&gt;RangeCount) {
 		DPRINT_INFO(NETVSC, "Needed %d netvsc pkts to satisy this xfer "
@@ -1125,9 +1126,9 @@ static void NetVscOnReceive(struct hv_device *Device,
 					vmxferpagePacket-&gt;Ranges[i].ByteCount;
 		netvscPacket-&gt;PageBufferCount = 1;
 
-		ASSERT(vmxferpagePacket-&gt;Ranges[i].ByteOffset +
-			vmxferpagePacket-&gt;Ranges[i].ByteCount &lt;
-			netDevice-&gt;ReceiveBufferSize);
+		/* ASSERT(vmxferpagePacket-&gt;Ranges[i].ByteOffset + */
+		/* 	vmxferpagePacket-&gt;Ranges[i].ByteCount &lt; */
+		/* 	netDevice-&gt;ReceiveBufferSize); */
 
 		netvscPacket-&gt;PageBuffers[0].Length =
 					vmxferpagePacket-&gt;Ranges[i].ByteCount;
@@ -1165,7 +1166,7 @@ static void NetVscOnReceive(struct hv_device *Device,
 				if (bytesRemain == 0)
 					break;
 			}
-			ASSERT(bytesRemain == 0);
+			/* ASSERT(bytesRemain == 0); */
 		}
 		DPRINT_DBG(NETVSC, "[%d] - (abs offset %u len %u) =&gt; "
 			   "(pfn %llx, offset %u, len %u)", i,
@@ -1181,7 +1182,7 @@ static void NetVscOnReceive(struct hv_device *Device,
 		NetVscOnReceiveCompletion(netvscPacket-&gt;Completion.Recv.ReceiveCompletionContext);
 	}
 
-	ASSERT(list_empty(&amp;listHead));
+	/* ASSERT(list_empty(&amp;listHead)); */
 
 	PutNetDevice(Device);
 	DPRINT_EXIT(NETVSC);
@@ -1245,7 +1246,7 @@ static void NetVscOnReceiveCompletion(void *Context)
 
 	DPRINT_ENTER(NETVSC);
 
-	ASSERT(packet-&gt;XferPagePacket);
+	/* ASSERT(packet-&gt;XferPagePacket); */
 
 	/*
 	 * Even though it seems logical to do a GetOutboundNetDevice() here to
@@ -1263,7 +1264,7 @@ static void NetVscOnReceiveCompletion(void *Context)
 	/* Overloading use of the lock. */
 	spin_lock_irqsave(&amp;netDevice-&gt;receive_packet_list_lock, flags);
 
-	ASSERT(packet-&gt;XferPagePacket-&gt;Count &gt; 0);
+	/* ASSERT(packet-&gt;XferPagePacket-&gt;Count &gt; 0); */
 	packet-&gt;XferPagePacket-&gt;Count--;
 
 	/*
@@ -1305,7 +1306,7 @@ static void NetVscOnChannelCallback(void *Context)
 
 	DPRINT_ENTER(NETVSC);
 
-	ASSERT(device);
+	/* ASSERT(device); */
 
 	packet = kzalloc(NETVSC_PACKET_SIZE * sizeof(unsigned char),
 			 GFP_KERNEL);
@@ -1377,8 +1378,6 @@ static void NetVscOnChannelCallback(void *Context)
 			}
 
 			bufferlen = bytesRecvd;
-		} else {
-			ASSERT(0);
 		}
 	} while (1);
 </pre><hr><pre>commit a3810b0ef61d23f37ace99ed0fb180b62fcb3f68
Author: Bill Pemberton &lt;wfp5p@virginia.edu&gt;
Date:   Wed May 5 15:27:51 2010 -0400

    staging: hv: remove ASSERT()s in vmbus_drv.c
    
    These ASSERT()s serve no purpose other than for debugging.
    
    Signed-off-by: Bill Pemberton &lt;wfp5p@virginia.edu&gt;
    Cc: Hank Janssen &lt;hjanssen@microsoft.com&gt;
    Cc: Haiyang Zhang &lt;haiyangz@microsoft.com&gt;
    Signed-off-by: Greg Kroah-Hartman &lt;gregkh@suse.de&gt;

diff --git a/drivers/staging/hv/vmbus_drv.c b/drivers/staging/hv/vmbus_drv.c
index d2a82aa3bbd8..a715b3db87ce 100644
--- a/drivers/staging/hv/vmbus_drv.c
+++ b/drivers/staging/hv/vmbus_drv.c
@@ -923,7 +923,7 @@ static void vmbus_msg_dpc(unsigned long data)
 
 	DPRINT_ENTER(VMBUS_DRV);
 
-	ASSERT(vmbus_drv_obj-&gt;OnMsgDpc != NULL);
+	/* ASSERT(vmbus_drv_obj-&gt;OnMsgDpc != NULL); */
 
 	/* Call to bus driver to handle interrupt */
 	vmbus_drv_obj-&gt;OnMsgDpc(&amp;vmbus_drv_obj-&gt;Base);
@@ -940,7 +940,7 @@ static void vmbus_event_dpc(unsigned long data)
 
 	DPRINT_ENTER(VMBUS_DRV);
 
-	ASSERT(vmbus_drv_obj-&gt;OnEventDpc != NULL);
+	/* ASSERT(vmbus_drv_obj-&gt;OnEventDpc != NULL); */
 
 	/* Call to bus driver to handle interrupt */
 	vmbus_drv_obj-&gt;OnEventDpc(&amp;vmbus_drv_obj-&gt;Base);
@@ -955,7 +955,7 @@ static irqreturn_t vmbus_isr(int irq, void *dev_id)
 
 	DPRINT_ENTER(VMBUS_DRV);
 
-	ASSERT(vmbus_driver_obj-&gt;OnIsr != NULL);
+	/* ASSERT(vmbus_driver_obj-&gt;OnIsr != NULL); */
 
 	/* Call to bus driver to handle interrupt */
 	ret = vmbus_driver_obj-&gt;OnIsr(&amp;vmbus_driver_obj-&gt;Base);</pre><hr><pre>commit a16e1485c758c236915ac1956694d11bff5e5daa
Author: Bill Pemberton &lt;wfp5p@virginia.edu&gt;
Date:   Wed May 5 15:27:50 2010 -0400

    staging: hv: remove ASSERT()s and return -EINVAL in RingBuffer.c
    
    return -EINVAL instead of calling ASSERT() for these conditionals.
    
    Signed-off-by: Bill Pemberton &lt;wfp5p@virginia.edu&gt;
    Cc: Hank Janssen &lt;hjanssen@microsoft.com&gt;
    Cc: Haiyang Zhang &lt;haiyangz@microsoft.com&gt;
    Signed-off-by: Greg Kroah-Hartman &lt;gregkh@suse.de&gt;

diff --git a/drivers/staging/hv/RingBuffer.c b/drivers/staging/hv/RingBuffer.c
index 69f3ebae15a9..64f8d0f9e05c 100644
--- a/drivers/staging/hv/RingBuffer.c
+++ b/drivers/staging/hv/RingBuffer.c
@@ -490,7 +490,8 @@ int RingBufferRead(RING_BUFFER_INFO *InRingInfo, void *Buffer,
 	u64 prevIndices = 0;
 	unsigned long flags;
 
-	ASSERT(BufferLen &gt; 0);
+	if (BufferLen &lt;= 0)
+		return -EINVAL;
 
 	spin_lock_irqsave(&amp;InRingInfo-&gt;ring_lock, flags);
 </pre><hr><pre>commit 3324fb405340cf52fe361697a86d235587402d9c
Author: Bill Pemberton &lt;wfp5p@virginia.edu&gt;
Date:   Wed May 5 15:27:49 2010 -0400

    staging: hv: check return value of RingBufferInit()
    
    RingBufferInit() would always return sucess and instead relied on an
    ASSERT() to test for an error condition.  Remove the ASSERT() and
    return -EINVAL instead.  The return value of RingBufferInit() was also
    never checked, so check it.
    
    Signed-off-by: Bill Pemberton &lt;wfp5p@virginia.edu&gt;
    Cc: Hank Janssen &lt;hjanssen@microsoft.com&gt;
    Cc: Haiyang Zhang &lt;haiyangz@microsoft.com&gt;
    Signed-off-by: Greg Kroah-Hartman &lt;gregkh@suse.de&gt;

diff --git a/drivers/staging/hv/Channel.c b/drivers/staging/hv/Channel.c
index a1431e4ac8be..158f62d8553a 100644
--- a/drivers/staging/hv/Channel.c
+++ b/drivers/staging/hv/Channel.c
@@ -203,9 +203,18 @@ int VmbusChannelOpen(struct vmbus_channel *NewChannel, u32 SendRingBufferSize,
 	NewChannel-&gt;RingBufferPageCount = (SendRingBufferSize +
 					   RecvRingBufferSize) &gt;&gt; PAGE_SHIFT;
 
-	RingBufferInit(&amp;NewChannel-&gt;Outbound, out, SendRingBufferSize);
+	ret = RingBufferInit(&amp;NewChannel-&gt;Outbound, out, SendRingBufferSize);
+	if (!ret) {
+		err = ret;
+		goto errorout;
+	}
+
+	ret = RingBufferInit(&amp;NewChannel-&gt;Inbound, in, RecvRingBufferSize);
+	if (!ret) {
+		err = ret;
+		goto errorout;
+	}
 
-	RingBufferInit(&amp;NewChannel-&gt;Inbound, in, RecvRingBufferSize);
 
 	/* Establish the gpadl for the ring buffer */
 	DPRINT_DBG(VMBUS, "Establishing ring buffer's gpadl for channel %p...",
diff --git a/drivers/staging/hv/RingBuffer.c b/drivers/staging/hv/RingBuffer.c
index ee481fd972b7..69f3ebae15a9 100644
--- a/drivers/staging/hv/RingBuffer.c
+++ b/drivers/staging/hv/RingBuffer.c
@@ -301,7 +301,8 @@ u32 GetRingBufferInterruptMask(RING_BUFFER_INFO *rbi)
 --*/
 int RingBufferInit(RING_BUFFER_INFO *RingInfo, void *Buffer, u32 BufferLen)
 {
-	ASSERT(sizeof(RING_BUFFER) == PAGE_SIZE);
+	if (sizeof(RING_BUFFER) != PAGE_SIZE)
+		return -EINVAL;
 
 	memset(RingInfo, 0, sizeof(RING_BUFFER_INFO));
 </pre><hr><pre>commit 1bbdd7a5380239533c4bb648c5d5d9510f12974b
Author: Bill Pemberton &lt;wfp5p@virginia.edu&gt;
Date:   Wed May 5 15:27:48 2010 -0400

    staging: hv: remove ASSERT()s in RingBuffer.c
    
    These ASSERT()s serve no purpose other than for debugging.
    
    Signed-off-by: Bill Pemberton &lt;wfp5p@virginia.edu&gt;
    Cc: Hank Janssen &lt;hjanssen@microsoft.com&gt;
    Cc: Haiyang Zhang &lt;haiyangz@microsoft.com&gt;
    Signed-off-by: Greg Kroah-Hartman &lt;gregkh@suse.de&gt;

diff --git a/drivers/staging/hv/RingBuffer.c b/drivers/staging/hv/RingBuffer.c
index 08b3c5567e9c..ee481fd972b7 100644
--- a/drivers/staging/hv/RingBuffer.c
+++ b/drivers/staging/hv/RingBuffer.c
@@ -72,7 +72,7 @@ GetNextWriteLocation(RING_BUFFER_INFO *RingInfo)
 {
 	u32 next = RingInfo-&gt;RingBuffer-&gt;WriteIndex;
 
-	ASSERT(next &lt; RingInfo-&gt;RingDataSize);
+	/* ASSERT(next &lt; RingInfo-&gt;RingDataSize); */
 
 	return next;
 }
@@ -106,7 +106,7 @@ GetNextReadLocation(RING_BUFFER_INFO *RingInfo)
 {
 	u32 next = RingInfo-&gt;RingBuffer-&gt;ReadIndex;
 
-	ASSERT(next &lt; RingInfo-&gt;RingDataSize);
+	/* ASSERT(next &lt; RingInfo-&gt;RingDataSize); */
 
 	return next;
 }
@@ -126,7 +126,7 @@ GetNextReadLocationWithOffset(RING_BUFFER_INFO *RingInfo, u32 Offset)
 {
 	u32 next = RingInfo-&gt;RingBuffer-&gt;ReadIndex;
 
-	ASSERT(next &lt; RingInfo-&gt;RingDataSize);
+	/* ASSERT(next &lt; RingInfo-&gt;RingDataSize); */
 	next += Offset;
 	next %= RingInfo-&gt;RingDataSize;
 </pre><hr><pre>commit 8a62d7168af111bb80d041e6ccf74987056c79d3
Author: Bill Pemberton &lt;wfp5p@virginia.edu&gt;
Date:   Wed May 5 15:27:47 2010 -0400

    staging: hv: remove ASSERT()s in RndisFilter.c
    
    return -EINVAL instead of calling ASSERT() for these conditionals.
    
    Signed-off-by: Bill Pemberton &lt;wfp5p@virginia.edu&gt;
    Cc: Hank Janssen &lt;hjanssen@microsoft.com&gt;
    Cc: Haiyang Zhang &lt;haiyangz@microsoft.com&gt;
    Signed-off-by: Greg Kroah-Hartman &lt;gregkh@suse.de&gt;

diff --git a/drivers/staging/hv/RndisFilter.c b/drivers/staging/hv/RndisFilter.c
index f0aacc0c84c9..597c972f22c2 100644
--- a/drivers/staging/hv/RndisFilter.c
+++ b/drivers/staging/hv/RndisFilter.c
@@ -391,7 +391,9 @@ static int RndisFilterOnReceive(struct hv_device *Device,
 
 	DPRINT_ENTER(NETVSC);
 
-	ASSERT(netDevice);
+	if (!netDevice)
+		return -EINVAL;
+
 	/* Make sure the rndis device state is initialized */
 	if (!netDevice-&gt;Extension) {
 		DPRINT_ERR(NETVSC, "got rndis message but no rndis device..."
@@ -492,7 +494,8 @@ static int RndisFilterQueryDevice(struct rndis_device *Device, u32 Oid,
 
 	DPRINT_ENTER(NETVSC);
 
-	ASSERT(Result);
+	if (!Result)
+		return -EINVAL;
 
 	*ResultSize = 0;
 	request = GetRndisRequest(Device, REMOTE_NDIS_QUERY_MSG,
@@ -885,7 +888,9 @@ int RndisFilterOnOpen(struct hv_device *Device)
 
 	DPRINT_ENTER(NETVSC);
 
-	ASSERT(netDevice);
+	if (!netDevice)
+		return -EINVAL;
+
 	ret = RndisFilterOpenDevice(netDevice-&gt;Extension);
 
 	DPRINT_EXIT(NETVSC);
@@ -900,7 +905,9 @@ int RndisFilterOnClose(struct hv_device *Device)
 
 	DPRINT_ENTER(NETVSC);
 
-	ASSERT(netDevice);
+	if (!netDevice)
+		return -EINVAL;
+
 	ret = RndisFilterCloseDevice(netDevice-&gt;Extension);
 
 	DPRINT_EXIT(NETVSC);</pre><hr><pre>commit 45e4431468f24748ba089b741713c740e854fccc
Author: Bill Pemberton &lt;wfp5p@virginia.edu&gt;
Date:   Wed May 5 15:27:46 2010 -0400

    staging: hv: remove ASSERT()s in RndisFilter.c
    
    These ASSERT()s serve no purpose other than for debugging.
    
    Signed-off-by: Bill Pemberton &lt;wfp5p@virginia.edu&gt;
    Cc: Hank Janssen &lt;hjanssen@microsoft.com&gt;
    Cc: Haiyang Zhang &lt;haiyangz@microsoft.com&gt;
    Signed-off-by: Greg Kroah-Hartman &lt;gregkh@suse.de&gt;

diff --git a/drivers/staging/hv/RndisFilter.c b/drivers/staging/hv/RndisFilter.c
index de4bc80341c3..f0aacc0c84c9 100644
--- a/drivers/staging/hv/RndisFilter.c
+++ b/drivers/staging/hv/RndisFilter.c
@@ -356,8 +356,8 @@ static void RndisFilterReceiveData(struct rndis_device *Device,
 	DPRINT_ENTER(NETVSC);
 
 	/* empty ethernet frame ?? */
-	ASSERT(Packet-&gt;PageBuffers[0].Length &gt;
-		RNDIS_MESSAGE_SIZE(struct rndis_packet));
+	/* ASSERT(Packet-&gt;PageBuffers[0].Length &gt; */
+	/* 	RNDIS_MESSAGE_SIZE(struct rndis_packet)); */
 
 	rndisPacket = &amp;Message-&gt;Message.Packet;
 
@@ -567,8 +567,8 @@ static int RndisFilterSetPacketFilter(struct rndis_device *Device,
 
 	DPRINT_ENTER(NETVSC);
 
-	ASSERT(RNDIS_MESSAGE_SIZE(struct rndis_set_request) + sizeof(u32) &lt;=
-		sizeof(struct rndis_message));
+	/* ASSERT(RNDIS_MESSAGE_SIZE(struct rndis_set_request) + sizeof(u32) &lt;= */
+	/* 	sizeof(struct rndis_message)); */
 
 	request = GetRndisRequest(Device, REMOTE_NDIS_SET_MSG,
 			RNDIS_MESSAGE_SIZE(struct rndis_set_request) +
@@ -640,8 +640,8 @@ int RndisFilterInit(struct netvsc_driver *Driver)
 					Driver-&gt;Base.OnDeviceRemove;
 	gRndisFilter.InnerDriver.Base.OnCleanup = Driver-&gt;Base.OnCleanup;
 
-	ASSERT(Driver-&gt;OnSend);
-	ASSERT(Driver-&gt;OnReceiveCallback);
+	/* ASSERT(Driver-&gt;OnSend); */
+	/* ASSERT(Driver-&gt;OnReceiveCallback); */
 	gRndisFilter.InnerDriver.OnSend = Driver-&gt;OnSend;
 	gRndisFilter.InnerDriver.OnReceiveCallback = Driver-&gt;OnReceiveCallback;
 	gRndisFilter.InnerDriver.OnLinkStatusChanged =
@@ -811,8 +811,8 @@ static int RndisFilterOnDeviceAdd(struct hv_device *Device,
 
 	/* Initialize the rndis device */
 	netDevice = Device-&gt;Extension;
-	ASSERT(netDevice);
-	ASSERT(netDevice-&gt;Device);
+	/* ASSERT(netDevice); */
+	/* ASSERT(netDevice-&gt;Device); */
 
 	netDevice-&gt;Extension = rndisDevice;
 	rndisDevice-&gt;NetDevice = netDevice;
@@ -921,7 +921,7 @@ static int RndisFilterOnSend(struct hv_device *Device,
 
 	/* Add the rndis header */
 	filterPacket = (struct rndis_filter_packet *)Packet-&gt;Extension;
-	ASSERT(filterPacket);
+	/* ASSERT(filterPacket); */
 
 	memset(filterPacket, 0, sizeof(struct rndis_filter_packet));
 </pre><hr><pre>commit e2e64432e9b76e8170d64b25a40feec991822555
Author: Bill Pemberton &lt;wfp5p@virginia.edu&gt;
Date:   Wed May 5 15:27:45 2010 -0400

    staging: hv: remove ASSERT()s in StorVsc.c
    
    These ASSERT()s serve no purpose other than for debugging.
    
    Signed-off-by: Bill Pemberton &lt;wfp5p@virginia.edu&gt;
    Cc: Hank Janssen &lt;hjanssen@microsoft.com&gt;
    Cc: Haiyang Zhang &lt;haiyangz@microsoft.com&gt;
    Signed-off-by: Greg Kroah-Hartman &lt;gregkh@suse.de&gt;

diff --git a/drivers/staging/hv/StorVsc.c b/drivers/staging/hv/StorVsc.c
index 4d0fbce229e2..e73130e49cce 100644
--- a/drivers/staging/hv/StorVsc.c
+++ b/drivers/staging/hv/StorVsc.c
@@ -100,7 +100,7 @@ static inline struct storvsc_device *AllocStorDevice(struct hv_device *Device)
 
 static inline void FreeStorDevice(struct storvsc_device *Device)
 {
-	ASSERT(atomic_read(&amp;Device-&gt;RefCount) == 0);
+	/* ASSERT(atomic_read(&amp;Device-&gt;RefCount) == 0); */
 	kfree(Device);
 }
 
@@ -137,10 +137,10 @@ static inline void PutStorDevice(struct hv_device *Device)
 	struct storvsc_device *storDevice;
 
 	storDevice = (struct storvsc_device *)Device-&gt;Extension;
-	ASSERT(storDevice);
+	/* ASSERT(storDevice); */
 
 	atomic_dec(&amp;storDevice-&gt;RefCount);
-	ASSERT(atomic_read(&amp;storDevice-&gt;RefCount));
+	/* ASSERT(atomic_read(&amp;storDevice-&gt;RefCount)); */
 }
 
 /* Drop ref count to 1 to effectively disable GetStorDevice() */
@@ -149,7 +149,7 @@ static inline struct storvsc_device *ReleaseStorDevice(struct hv_device *Device)
 	struct storvsc_device *storDevice;
 
 	storDevice = (struct storvsc_device *)Device-&gt;Extension;
-	ASSERT(storDevice);
+	/* ASSERT(storDevice); */
 
 	/* Busy wait until the ref drop to 2, then set it to 1 */
 	while (atomic_cmpxchg(&amp;storDevice-&gt;RefCount, 2, 1) != 2)
@@ -165,7 +165,7 @@ static inline struct storvsc_device *FinalReleaseStorDevice(
 	struct storvsc_device *storDevice;
 
 	storDevice = (struct storvsc_device *)Device-&gt;Extension;
-	ASSERT(storDevice);
+	/* ASSERT(storDevice); */
 
 	/* Busy wait until the ref drop to 1, then set it to 0 */
 	while (atomic_cmpxchg(&amp;storDevice-&gt;RefCount, 1, 0) != 1)
@@ -370,12 +370,12 @@ static void StorVscOnIOCompletion(struct hv_device *Device,
 		   "completed bytes xfer %u", RequestExt,
 		   VStorPacket-&gt;VmSrb.DataTransferLength);
 
-	ASSERT(RequestExt != NULL);
-	ASSERT(RequestExt-&gt;Request != NULL);
+	/* ASSERT(RequestExt != NULL); */
+	/* ASSERT(RequestExt-&gt;Request != NULL); */
 
 	request = RequestExt-&gt;Request;
 
-	ASSERT(request-&gt;OnIOCompletion != NULL);
+	/* ASSERT(request-&gt;OnIOCompletion != NULL); */
 
 	/* Copy over the status...etc */
 	request-&gt;Status = VStorPacket-&gt;VmSrb.ScsiStatus;
@@ -395,8 +395,8 @@ static void StorVscOnIOCompletion(struct hv_device *Device,
 				    "valid - len %d\n", RequestExt,
 				    VStorPacket-&gt;VmSrb.SenseInfoLength);
 
-			ASSERT(VStorPacket-&gt;VmSrb.SenseInfoLength &lt;=
-				request-&gt;SenseBufferSize);
+			/* ASSERT(VStorPacket-&gt;VmSrb.SenseInfoLength &lt;= */
+			/* 	request-&gt;SenseBufferSize); */
 			memcpy(request-&gt;SenseBuffer,
 			       VStorPacket-&gt;VmSrb.SenseData,
 			       VStorPacket-&gt;VmSrb.SenseInfoLength);
@@ -451,7 +451,7 @@ static void StorVscOnChannelCallback(void *context)
 
 	DPRINT_ENTER(STORVSC);
 
-	ASSERT(device);
+	/* ASSERT(device); */
 
 	storDevice = MustGetStorDevice(device);
 	if (!storDevice) {
@@ -474,7 +474,7 @@ static void StorVscOnChannelCallback(void *context)
 
 			request = (struct storvsc_request_extension *)
 					(unsigned long)requestId;
-			ASSERT(request);
+			/* ASSERT(request);c */
 
 			/* if (vstorPacket.Flags &amp; SYNTHETIC_FLAG) */
 			if ((request == &amp;storDevice-&gt;InitRequest) ||
@@ -821,7 +821,7 @@ int StorVscInitialize(struct hv_driver *Driver)
 		   sizeof(struct vmscsi_request));
 
 	/* Make sure we are at least 2 pages since 1 page is used for control */
-	ASSERT(storDriver-&gt;RingBufferSize &gt;= (PAGE_SIZE &lt;&lt; 1));
+	/* ASSERT(storDriver-&gt;RingBufferSize &gt;= (PAGE_SIZE &lt;&lt; 1)); */
 
 	Driver-&gt;name = gDriverName;
 	memcpy(&amp;Driver-&gt;deviceType, &amp;gStorVscDeviceType,</pre><hr><pre>commit 4e5166b5d83e748014f6f22a4f8a3537294ced9b
Author: Bill Pemberton &lt;wfp5p@virginia.edu&gt;
Date:   Wed May 5 15:27:44 2010 -0400

    staging: hv: remove ASSERT()s in blkvsc_drv.c
    
    These ASSERT()s serve no purpose other than for debugging.
    
    Signed-off-by: Bill Pemberton &lt;wfp5p@virginia.edu&gt;
    Cc: Hank Janssen &lt;hjanssen@microsoft.com&gt;
    Cc: Haiyang Zhang &lt;haiyangz@microsoft.com&gt;
    Signed-off-by: Greg Kroah-Hartman &lt;gregkh@suse.de&gt;

diff --git a/drivers/staging/hv/blkvsc_drv.c b/drivers/staging/hv/blkvsc_drv.c
index 8a25154c06f5..78fc348334e7 100644
--- a/drivers/staging/hv/blkvsc_drv.c
+++ b/drivers/staging/hv/blkvsc_drv.c
@@ -288,8 +288,8 @@ static int blkvsc_probe(struct device *device)
 	/* Initialize what we can here */
 	spin_lock_init(&amp;blkdev-&gt;lock);
 
-	ASSERT(sizeof(struct blkvsc_request_group) &lt;=
-		sizeof(struct blkvsc_request));
+	/* ASSERT(sizeof(struct blkvsc_request_group) &lt;= */
+	/* 	sizeof(struct blkvsc_request)); */
 
 	blkdev-&gt;request_pool = kmem_cache_create(dev_name(&amp;device_ctx-&gt;device),
 					sizeof(struct blkvsc_request) +
@@ -808,8 +808,8 @@ static int blkvsc_remove(struct device *device)
 
 static void blkvsc_init_rw(struct blkvsc_request *blkvsc_req)
 {
-	ASSERT(blkvsc_req-&gt;req);
-	ASSERT(blkvsc_req-&gt;sector_count &lt;= (MAX_MULTIPAGE_BUFFER_COUNT*8));
+	/* ASSERT(blkvsc_req-&gt;req); */
+	/* ASSERT(blkvsc_req-&gt;sector_count &lt;= (MAX_MULTIPAGE_BUFFER_COUNT*8)); */
 
 	blkvsc_req-&gt;cmd_len = 16;
 
@@ -1116,7 +1116,7 @@ static void blkvsc_request_completion(struct hv_storvsc_request *request)
 	unsigned long flags;
 	struct blkvsc_request *comp_req, *tmp;
 
-	ASSERT(blkvsc_req-&gt;group);
+	/* ASSERT(blkvsc_req-&gt;group); */
 
 	DPRINT_DBG(BLKVSC_DRV, "blkdev %p blkvsc_req %p group %p type %s "
 		   "sect_start %lu sect_count %ld len %d group outstd %d "</pre>
    <div class="pagination">
        <a href='3_44.html'>&lt;&lt;Prev</a><a href='3.html'>1</a><a href='3_2.html'>2</a><a href='3_3.html'>3</a><a href='3_4.html'>4</a><a href='3_5.html'>5</a><a href='3_6.html'>6</a><a href='3_7.html'>7</a><a href='3_8.html'>8</a><a href='3_9.html'>9</a><a href='3_10.html'>10</a><a href='3_11.html'>11</a><a href='3_12.html'>12</a><a href='3_13.html'>13</a><a href='3_14.html'>14</a><a href='3_15.html'>15</a><a href='3_16.html'>16</a><a href='3_17.html'>17</a><a href='3_18.html'>18</a><a href='3_19.html'>19</a><a href='3_20.html'>20</a><a href='3_21.html'>21</a><a href='3_22.html'>22</a><a href='3_23.html'>23</a><a href='3_24.html'>24</a><a href='3_25.html'>25</a><a href='3_26.html'>26</a><a href='3_27.html'>27</a><a href='3_28.html'>28</a><a href='3_29.html'>29</a><a href='3_30.html'>30</a><a href='3_31.html'>31</a><a href='3_32.html'>32</a><a href='3_33.html'>33</a><a href='3_34.html'>34</a><a href='3_35.html'>35</a><a href='3_36.html'>36</a><a href='3_37.html'>37</a><a href='3_38.html'>38</a><a href='3_39.html'>39</a><a href='3_40.html'>40</a><a href='3_41.html'>41</a><a href='3_42.html'>42</a><a href='3_43.html'>43</a><a href='3_44.html'>44</a><span>[45]</span><a href='3_46.html'>46</a><a href='3_47.html'>47</a><a href='3_48.html'>48</a><a href='3_49.html'>49</a><a href='3_50.html'>50</a><a href='3_51.html'>51</a><a href='3_52.html'>52</a><a href='3_53.html'>53</a><a href='3_54.html'>54</a><a href='3_55.html'>55</a><a href='3_56.html'>56</a><a href='3_57.html'>57</a><a href='3_58.html'>58</a><a href='3_59.html'>59</a><a href='3_60.html'>60</a><a href='3_61.html'>61</a><a href='3_62.html'>62</a><a href='3_63.html'>63</a><a href='3_64.html'>64</a><a href='3_65.html'>65</a><a href='3_66.html'>66</a><a href='3_67.html'>67</a><a href='3_68.html'>68</a><a href='3_69.html'>69</a><a href='3_70.html'>70</a><a href='3_71.html'>71</a><a href='3_72.html'>72</a><a href='3_73.html'>73</a><a href='3_74.html'>74</a><a href='3_75.html'>75</a><a href='3_76.html'>76</a><a href='3_77.html'>77</a><a href='3_78.html'>78</a><a href='3_79.html'>79</a><a href='3_80.html'>80</a><a href='3_81.html'>81</a><a href='3_82.html'>82</a><a href='3_83.html'>83</a><a href='3_46.html'>Next&gt;&gt;</a>
    <div>
</body>
