<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patches contributed by Iowa State University</title>
    <style>
    .pagination {
        border-top: 1px solid #ddd;
        border-bottom: 1px solid #ddd;
        overflow-wrap: break-word;
    }
    .pagination a, .pagination span {
        margin: 0 4px;
    }

    </style>
</head>
<body>
    <h1>Patches contributed by Iowa State University</h1>
    <div class="pagination">
        <span>[1]</span>
    </div>
    <hr>
    <pre>commit 4143d178e7b39c00d5277040c69a1522c4d98871
Author: Steve Holland &lt;sdh4@iastate.edu&gt;
Date:   Thu Jun 18 17:37:49 2009 -0500

    USB: usbtmc: correct termination condition for reads.
    
    Follow T&amp;M convention of obeying EOM flag.  Avoid exception cases where
    instrument response size matches a buffer size.
    
    Signed-off-by: Steve Holland &lt;sdh4@iastate.edu&gt;
    Signed-off-by: Greg Kroah-Hartman &lt;gregkh@suse.de&gt;

diff --git a/drivers/usb/class/usbtmc.c b/drivers/usb/class/usbtmc.c
index 91d3a94eeaa0..6395f22a58e1 100644
--- a/drivers/usb/class/usbtmc.c
+++ b/drivers/usb/class/usbtmc.c
@@ -485,7 +485,8 @@ static ssize_t usbtmc_read(struct file *filp, char __user *buf,
 		}
 
 		done += n_characters;
-		if (n_characters &lt; USBTMC_SIZE_IOBUFFER)
+		/* Terminate if end-of-message bit recieved from device */
+		if ((buffer[8] &amp;  0x01) &amp;&amp; (actual &gt;= n_characters + 12))
 			remaining = 0;
 		else
 			remaining -= n_characters;</pre><hr><pre>commit 92d07e422df3cc5370d0d9b95a671abb69d50ef1
Author: Steve Holland &lt;sdh4@iastate.edu&gt;
Date:   Thu Jun 18 17:37:49 2009 -0500

    USB: usbtmc: inhibit corruption
    
    Limit data copied to userspace to amount requested.  Prevents a faulty
    instrument from overwriting user memory.
    
    Signed-off-by: Steve Holland &lt;sdh4@iastate.edu&gt;
    Signed-off-by: Greg Kroah-Hartman &lt;gregkh@suse.de&gt;

diff --git a/drivers/usb/class/usbtmc.c b/drivers/usb/class/usbtmc.c
index f2fde7cd6109..91d3a94eeaa0 100644
--- a/drivers/usb/class/usbtmc.c
+++ b/drivers/usb/class/usbtmc.c
@@ -473,6 +473,10 @@ static ssize_t usbtmc_read(struct file *filp, char __user *buf,
 			n_characters = this_part;
 		}
 
+		/* Bound amount of data received by amount of data requested */
+		if (n_characters &gt; this_part)
+			n_characters = this_part;
+
 		/* Copy buffer to user space */
 		if (copy_to_user(buf + done, &amp;buffer[12], n_characters)) {
 			/* There must have been an addressing problem */</pre><hr><pre>commit c2cd26e15b84b964c489f2aff278cdaf03840c93
Author: Steve Holland &lt;sdh4@iastate.edu&gt;
Date:   Thu Jun 18 17:37:49 2009 -0500

    USB: usbtmc: Fix short reads in usbtmc_read()
    
    The header size should not be included in the number of bytes requested of the
    instrument
    
    Signed-off-by: Steve Holland &lt;sdh4@iastate.edu&gt;
    Signed-off-by: Greg Kroah-Hartman &lt;gregkh@suse.de&gt;

diff --git a/drivers/usb/class/usbtmc.c b/drivers/usb/class/usbtmc.c
index 40ef4da786d8..f2fde7cd6109 100644
--- a/drivers/usb/class/usbtmc.c
+++ b/drivers/usb/class/usbtmc.c
@@ -407,10 +407,10 @@ static ssize_t usbtmc_read(struct file *filp, char __user *buf,
 		buffer[1] = data-&gt;bTag;
 		buffer[2] = ~(data-&gt;bTag);
 		buffer[3] = 0; /* Reserved */
-		buffer[4] = (this_part - 12 - 3) &amp; 255;
-		buffer[5] = ((this_part - 12 - 3) &gt;&gt; 8) &amp; 255;
-		buffer[6] = ((this_part - 12 - 3) &gt;&gt; 16) &amp; 255;
-		buffer[7] = ((this_part - 12 - 3) &gt;&gt; 24) &amp; 255;
+		buffer[4] = (this_part) &amp; 255;
+		buffer[5] = ((this_part) &gt;&gt; 8) &amp; 255;
+		buffer[6] = ((this_part) &gt;&gt; 16) &amp; 255;
+		buffer[7] = ((this_part) &gt;&gt; 24) &amp; 255;
 		buffer[8] = data-&gt;TermCharEnabled * 2;
 		/* Use term character? */
 		buffer[9] = data-&gt;TermChar;</pre><hr><pre>commit b93ff78317c0b8f42830e2bb13dd8df596232528
Author: Daniel De Graaf &lt;danield@iastate.edu&gt;
Date:   Tue Aug 22 00:30:55 2006 -0700

    [NETFILTER]: ipt_recent: add module parameter for changing ownership of /proc/net/ipt_recent/*
    
    Signed-off-by: Daniel De Graaf &lt;danield@iastate.edu&gt;
    Signed-off-by: Patrick McHardy &lt;kaber@trash.net&gt;
    Signed-off-by: David S. Miller &lt;davem@davemloft.net&gt;

diff --git a/net/ipv4/netfilter/ipt_recent.c b/net/ipv4/netfilter/ipt_recent.c
index 61a2139f9cfd..682c0946201e 100644
--- a/net/ipv4/netfilter/ipt_recent.c
+++ b/net/ipv4/netfilter/ipt_recent.c
@@ -35,14 +35,20 @@ static unsigned int ip_list_tot = 100;
 static unsigned int ip_pkt_list_tot = 20;
 static unsigned int ip_list_hash_size = 0;
 static unsigned int ip_list_perms = 0644;
+static unsigned int ip_list_uid = 0;
+static unsigned int ip_list_gid = 0;
 module_param(ip_list_tot, uint, 0400);
 module_param(ip_pkt_list_tot, uint, 0400);
 module_param(ip_list_hash_size, uint, 0400);
 module_param(ip_list_perms, uint, 0400);
+module_param(ip_list_uid, uint, 0400);
+module_param(ip_list_gid, uint, 0400);
 MODULE_PARM_DESC(ip_list_tot, "number of IPs to remember per list");
 MODULE_PARM_DESC(ip_pkt_list_tot, "number of packets per IP to remember (max. 255)");
 MODULE_PARM_DESC(ip_list_hash_size, "size of hash table used to look up IPs");
 MODULE_PARM_DESC(ip_list_perms, "permissions on /proc/net/ipt_recent/* files");
+MODULE_PARM_DESC(ip_list_uid,"owner of /proc/net/ipt_recent/* files");
+MODULE_PARM_DESC(ip_list_gid,"owning group of /proc/net/ipt_recent/* files");
 
 
 struct recent_entry {
@@ -274,6 +280,8 @@ ipt_recent_checkentry(const char *tablename, const void *ip,
 		goto out;
 	}
 	t-&gt;proc-&gt;proc_fops = &amp;recent_fops;
+	t-&gt;proc-&gt;uid       = ip_list_uid;
+	t-&gt;proc-&gt;gid       = ip_list_gid;
 	t-&gt;proc-&gt;data      = t;
 #endif
 	spin_lock_bh(&amp;recent_lock);</pre>
    <div class="pagination">
        <span>[1]</span>
    <div>
</body>
