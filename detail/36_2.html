<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patches contributed by Shanghai Jiaotong University</title>
    <style>
    .pagination {
        border-top: 1px solid #ddd;
        border-bottom: 1px solid #ddd;
        overflow-wrap: break-word;
    }
    .pagination a, .pagination span {
        margin: 0 4px;
    }

    </style>
</head>
<body>
    <h1>Patches contributed by Shanghai Jiaotong University</h1>
    <div class="pagination">
        <a href='36.html'>&lt;&lt;Prev</a><a href='36.html'>1</a><span>[2]</span>
    </div>
    <hr>
    <pre>commit cd28aa2e056cd1ea79fc5f24eed0ce868c6cab5c
Author: Wang Xiayang &lt;xywang.sjtu@sjtu.edu.cn&gt;
Date:   Wed Jul 31 15:31:14 2019 +0800

    can: sja1000: force the string buffer NULL-terminated
    
    strncpy() does not ensure NULL-termination when the input string size
    equals to the destination buffer size IFNAMSIZ. The output string
    'name' is passed to dev_info which relies on NULL-termination.
    
    Use strlcpy() instead.
    
    This issue is identified by a Coccinelle script.
    
    Signed-off-by: Wang Xiayang &lt;xywang.sjtu@sjtu.edu.cn&gt;
    Signed-off-by: Marc Kleine-Budde &lt;mkl@pengutronix.de&gt;

diff --git a/drivers/net/can/sja1000/peak_pcmcia.c b/drivers/net/can/sja1000/peak_pcmcia.c
index 185c7f7d38a4..5e0d5e8101c8 100644
--- a/drivers/net/can/sja1000/peak_pcmcia.c
+++ b/drivers/net/can/sja1000/peak_pcmcia.c
@@ -479,7 +479,7 @@ static void pcan_free_channels(struct pcan_pccard *card)
 		if (!netdev)
 			continue;
 
-		strncpy(name, netdev-&gt;name, IFNAMSIZ);
+		strlcpy(name, netdev-&gt;name, IFNAMSIZ);
 
 		unregister_sja1000dev(netdev);
 </pre><hr><pre>commit 929e571c04c285861e0bb049a396a2bdaea63282
Author: Wang Xiayang &lt;xywang.sjtu@sjtu.edu.cn&gt;
Date:   Sat Jul 27 17:30:30 2019 +0800

    drm/amdgpu: fix a potential information leaking bug
    
    Coccinelle reports a path that the array "data" is never initialized.
    The path skips the checks in the conditional branches when either
    of callback functions, read_wave_vgprs and read_wave_sgprs, is not
    registered. Later, the uninitialized "data" array is read
    in the while-loop below and passed to put_user().
    
    Fix the path by allocating the array with kcalloc().
    
    The patch is simplier than adding a fall-back branch that explicitly
    calls memset(data, 0, ...). Also it does not need the multiplication
    1024*sizeof(*data) as the size parameter for memset() though there is
    no risk of integer overflow.
    
    Signed-off-by: Wang Xiayang &lt;xywang.sjtu@sjtu.edu.cn&gt;
    Reviewed-by: Chunming Zhou &lt;david1.zhou@amd.com&gt;
    Reviewed-by: Christian König &lt;christian.koenig@amd.com&gt;
    Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;

diff --git a/drivers/gpu/drm/amd/amdgpu/amdgpu_debugfs.c b/drivers/gpu/drm/amd/amdgpu/amdgpu_debugfs.c
index 6d54decef7f8..5652cc72ed3a 100644
--- a/drivers/gpu/drm/amd/amdgpu/amdgpu_debugfs.c
+++ b/drivers/gpu/drm/amd/amdgpu/amdgpu_debugfs.c
@@ -707,7 +707,7 @@ static ssize_t amdgpu_debugfs_gpr_read(struct file *f, char __user *buf,
 	thread = (*pos &amp; GENMASK_ULL(59, 52)) &gt;&gt; 52;
 	bank = (*pos &amp; GENMASK_ULL(61, 60)) &gt;&gt; 60;
 
-	data = kmalloc_array(1024, sizeof(*data), GFP_KERNEL);
+	data = kcalloc(1024, sizeof(*data), GFP_KERNEL);
 	if (!data)
 		return -ENOMEM;
 </pre><hr><pre>commit 1a2c29bce06083e0f53f3a328f0bb43a2856b622
Author: Wang Xiayang &lt;xywang.sjtu@sjtu.edu.cn&gt;
Date:   Sat Jul 27 17:30:30 2019 +0800

    drm/amdgpu: fix a potential information leaking bug
    
    Coccinelle reports a path that the array "data" is never initialized.
    The path skips the checks in the conditional branches when either
    of callback functions, read_wave_vgprs and read_wave_sgprs, is not
    registered. Later, the uninitialized "data" array is read
    in the while-loop below and passed to put_user().
    
    Fix the path by allocating the array with kcalloc().
    
    The patch is simplier than adding a fall-back branch that explicitly
    calls memset(data, 0, ...). Also it does not need the multiplication
    1024*sizeof(*data) as the size parameter for memset() though there is
    no risk of integer overflow.
    
    Signed-off-by: Wang Xiayang &lt;xywang.sjtu@sjtu.edu.cn&gt;
    Reviewed-by: Chunming Zhou &lt;david1.zhou@amd.com&gt;
    Reviewed-by: Christian König &lt;christian.koenig@amd.com&gt;
    Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;

diff --git a/drivers/gpu/drm/amd/amdgpu/amdgpu_debugfs.c b/drivers/gpu/drm/amd/amdgpu/amdgpu_debugfs.c
index 6d54decef7f8..5652cc72ed3a 100644
--- a/drivers/gpu/drm/amd/amdgpu/amdgpu_debugfs.c
+++ b/drivers/gpu/drm/amd/amdgpu/amdgpu_debugfs.c
@@ -707,7 +707,7 @@ static ssize_t amdgpu_debugfs_gpr_read(struct file *f, char __user *buf,
 	thread = (*pos &amp; GENMASK_ULL(59, 52)) &gt;&gt; 52;
 	bank = (*pos &amp; GENMASK_ULL(61, 60)) &gt;&gt; 60;
 
-	data = kmalloc_array(1024, sizeof(*data), GFP_KERNEL);
+	data = kcalloc(1024, sizeof(*data), GFP_KERNEL);
 	if (!data)
 		return -ENOMEM;
 </pre><hr><pre>commit 3bd532692d93a9c72f4f11e38437b30c0e13007f
Author: Wang Xiayang &lt;xywang.sjtu@sjtu.edu.cn&gt;
Date:   Mon Jul 15 16:53:01 2019 +0800

    drm/amdgpu: replace simple_strtol() by kstrtou32()
    
    The simple_strtol() function is deprecated. kstrto[l,u32]() is
    the correct replacement as it can properly handle overflows.
    
    This patch replaces the deprecated simple_strtol() use introduced recently.
    As clk is of type uint32_t, we are safe to use kstrtou32().
    
    It is also safe to return zero on string parsing error,
    similar to the case of returning zero if buf is empty in parse_clk().
    
    Fixes: bb5a2bdf36a8 ("drm/amdgpu: support dpm level modification under virtualization v3")
    Signed-off-by: Wang Xiayang &lt;xywang.sjtu@sjtu.edu.cn&gt;
    Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;

diff --git a/drivers/gpu/drm/amd/amdgpu/amdgpu_virt.c b/drivers/gpu/drm/amd/amdgpu/amdgpu_virt.c
index 07a7e3820b7b..59dd204498c5 100644
--- a/drivers/gpu/drm/amd/amdgpu/amdgpu_virt.c
+++ b/drivers/gpu/drm/amd/amdgpu/amdgpu_virt.c
@@ -390,7 +390,8 @@ static uint32_t parse_clk(char *buf, bool min)
                 if (!ptr)
                         break;
                 ptr+=2;
-                clk = simple_strtoul(ptr, NULL, 10);
+		if (kstrtou32(ptr, 10, &amp;clk))
+			return 0;
         } while (!min);
 
         return clk * 100;</pre><hr><pre>commit 48282969826b3d3c76e908182f69724d86d995fe
Author: 王振杰 &lt;zhenjie.wang@sjtu.edu.cn&gt;
Date:   Wed Jan 10 16:12:22 2018 -0800

    Input: synaptics - Lenovo Thinkpad T460p devices should use RMI
    
    The tpouchpad/trackpoint on Lenovo Thinkpad T460p work with smbus/RMI.
    
    Signed-off-by: Zhenjie Wang &lt;zhenjie.wang@sjtu.edu.cn&gt;
    Signed-off-by: Dmitry Torokhov &lt;dmitry.torokhov@gmail.com&gt;

diff --git a/drivers/input/mouse/synaptics.c b/drivers/input/mouse/synaptics.c
index ee5466a374bf..cd9f61cb3fc6 100644
--- a/drivers/input/mouse/synaptics.c
+++ b/drivers/input/mouse/synaptics.c
@@ -173,6 +173,7 @@ static const char * const smbus_pnp_ids[] = {
 	"LEN0046", /* X250 */
 	"LEN004a", /* W541 */
 	"LEN200f", /* T450s */
+	"LEN2018", /* T460p */
 	NULL
 };
 </pre><hr><pre>commit 82836372311a5cbf9cc5f4f47f9b56cb9edfe90d
Author: Colin &lt;colins@sjtu.edu.cn&gt;
Date:   Tue May 27 00:04:43 2008 +0800

    [IPV6] TUNNEL6: Fix incoming packet length check for inter-protocol tunnel.
    
    I discover a strange behavior in [ipv4 in ipv6] tunnel. When IPv6 tunnel
    payload is less than 40(0x28), packet can be sent to network, received in
    physical interface, but not seen in IP tunnel interface. No counter increase
    in tunnel interface.
    
    Signed-off-by: YOSHIFUJI Hideaki &lt;yoshfuji@linux-ipv6.org&gt;

diff --git a/net/ipv6/tunnel6.c b/net/ipv6/tunnel6.c
index 6323921b40be..669f280989c3 100644
--- a/net/ipv6/tunnel6.c
+++ b/net/ipv6/tunnel6.c
@@ -109,7 +109,7 @@ static int tunnel46_rcv(struct sk_buff *skb)
 {
 	struct xfrm6_tunnel *handler;
 
-	if (!pskb_may_pull(skb, sizeof(struct ipv6hdr)))
+	if (!pskb_may_pull(skb, sizeof(struct iphdr)))
 		goto drop;
 
 	for (handler = tunnel46_handlers; handler; handler = handler-&gt;next)</pre>
    <div class="pagination">
        <a href='36.html'>&lt;&lt;Prev</a><a href='36.html'>1</a><span>[2]</span>
    <div>
</body>
