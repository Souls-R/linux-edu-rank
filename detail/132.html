<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patches contributed by Polish-Japanese Institute of Information Technology in Warsaw</title>
    <style>
    .pagination {
        border-top: 1px solid #ddd;
        border-bottom: 1px solid #ddd;
        overflow-wrap: break-word;
    }
    .pagination a, .pagination span {
        margin: 0 4px;
    }

    </style>
</head>
<body>
    <h1>Patches contributed by Polish-Japanese Institute of Information Technology in Warsaw</h1>
    <div class="pagination">
        <span>[1]</span>
    </div>
    <hr>
    <pre>commit 8d03e971cf403305217b8e62db3a2e5ad2d6263f
Author: Filip Palian &lt;s3810@pjwstk.edu.pl&gt;
Date:   Thu May 12 19:32:46 2011 +0200

    Bluetooth: l2cap and rfcomm: fix 1 byte infoleak to userspace.
    
    Structures "l2cap_conninfo" and "rfcomm_conninfo" have one padding
    byte each. This byte in "cinfo" is copied to userspace uninitialized.
    
    Signed-off-by: Filip Palian &lt;filip.palian@pjwstk.edu.pl&gt;
    Acked-by: Marcel Holtmann &lt;marcel@holtmann.org&gt;
    Signed-off-by: Gustavo F. Padovan &lt;padovan@profusion.mobi&gt;

diff --git a/net/bluetooth/l2cap_sock.c b/net/bluetooth/l2cap_sock.c
index 18dc9888d8c2..8248303f44e8 100644
--- a/net/bluetooth/l2cap_sock.c
+++ b/net/bluetooth/l2cap_sock.c
@@ -413,6 +413,7 @@ static int l2cap_sock_getsockopt_old(struct socket *sock, int optname, char __us
 			break;
 		}
 
+		memset(&amp;cinfo, 0, sizeof(cinfo));
 		cinfo.hci_handle = chan-&gt;conn-&gt;hcon-&gt;handle;
 		memcpy(cinfo.dev_class, chan-&gt;conn-&gt;hcon-&gt;dev_class, 3);
 
diff --git a/net/bluetooth/rfcomm/sock.c b/net/bluetooth/rfcomm/sock.c
index 386cfaffd4b7..1b10727ce523 100644
--- a/net/bluetooth/rfcomm/sock.c
+++ b/net/bluetooth/rfcomm/sock.c
@@ -788,6 +788,7 @@ static int rfcomm_sock_getsockopt_old(struct socket *sock, int optname, char __u
 
 		l2cap_sk = rfcomm_pi(sk)-&gt;dlc-&gt;session-&gt;sock-&gt;sk;
 
+		memset(&amp;cinfo, 0, sizeof(cinfo));
 		cinfo.hci_handle = conn-&gt;hcon-&gt;handle;
 		memcpy(cinfo.dev_class, conn-&gt;hcon-&gt;dev_class, 3);
 </pre>
    <div class="pagination">
        <span>[1]</span>
    <div>
</body>
